(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[576],{7402:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>I});var a=n(1246),o=n(268),i=n(7127),s=n.n(i),l=n(7882);n(2032);let c="https://nothing.studyspark.site/api";function r(){let e=localStorage.getItem("completed");return e?JSON.parse(e):[]}function d(e){localStorage.setItem("completed",JSON.stringify(e))}function p(e){return r().includes(e)}function u(e,t,n){var a,o;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=r(),l=s.includes(e),c=i||("dpp"===t?n.closest(".dpp-card"):null),p={lecture:{completeMsg:"Lecture marked as complete! \uD83C\uDF89",incompleteMsg:"Lecture marked as incomplete",updateUI:(e,t,n)=>{e&&e.classList.toggle("completed",n),t&&t.classList.toggle("completed",n)}},dpp:{completeMsg:"DPP marked as complete! \uD83D\uDCCB",incompleteMsg:"DPP marked as incomplete",updateUI:(e,t,n)=>{if(e){e.classList.toggle("completed",n);let t=e.querySelector(".dpp-card-content");t&&(n?t.setAttribute("data-completed","true"):t.removeAttribute("data-completed"))}t&&t.classList.toggle("completed",n)}}},u=p[t]||p.lecture;if(l?(s.splice(s.indexOf(e),1),u.updateUI(c,n,!1),null==(a=showNotification)||a(u.incompleteMsg,"info")):(s.push(e),u.updateUI(c,n,!0),null==(o=showNotification)||o(u.completeMsg,"success")),d(s),"dpp"===t){let t=!l;document.querySelectorAll('.dpp-nested-check[data-dpp-id="'.concat(e,'"]')).forEach(e=>{e.classList.toggle("completed",t);let n=e.closest(".dpp-nested-inner");n&&n.classList.toggle("completed",t)}),document.querySelectorAll(".dpp-card").forEach(n=>{let a=n.querySelector(".dpp-completion-button");if(a){let o=a.getAttribute("onclick");if(o&&o.includes("'".concat(e,"'"))){a.classList.toggle("completed",t),n.classList.toggle("completed",t);let e=n.querySelector(".dpp-card-content");e&&(t?e.setAttribute("data-completed","true"):e.removeAttribute("data-completed"))}}})}}function m(){let e=document.getElementById("telegramPopup");if(e){let t=window.scrollY;document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top="-".concat(t,"px"),document.body.style.width="100%",document.body.classList.add("popup-open"),document.documentElement.classList.add("popup-open"),document.body.setAttribute("data-scroll-y",t),e.style.display="flex"}}function h(){let e=document.getElementById("telegramPopup");if(e){let t=document.body.getAttribute("data-scroll-y")||0;document.body.classList.remove("popup-open"),document.documentElement.classList.remove("popup-open"),document.body.style.overflow="",document.documentElement.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,parseInt(t)),document.body.removeAttribute("data-scroll-y"),e.style.display="none"}}function y(){let e=document.getElementById("aiPopup");if(e){let t=window.scrollY;document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top="-".concat(t,"px"),document.body.style.width="100%",document.body.classList.add("ai-popup-open"),document.documentElement.classList.add("ai-popup-open"),document.body.setAttribute("data-ai-scroll-y",t),e.style.display="flex"}}function g(){let e=document.getElementById("aiPopup");if(e){let t=document.body.getAttribute("data-ai-scroll-y")||0;document.body.classList.remove("ai-popup-open"),document.documentElement.classList.remove("ai-popup-open"),document.body.style.overflow="",document.documentElement.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,parseInt(t)),document.body.removeAttribute("data-ai-scroll-y"),e.style.display="none"}}function f(){let e=document.getElementById("sidebar"),t=document.getElementById("sidebarOverlay"),n=document.getElementById("hamburgerMenu");if(e&&t){let a=window.scrollY;document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top="-".concat(a,"px"),document.body.style.width="100%",document.body.classList.add("sidebar-open"),document.documentElement.classList.add("sidebar-open"),document.body.setAttribute("data-sidebar-scroll-y",a),e.classList.add("open"),t.classList.add("active"),n.classList.add("active"),x()}}function b(){let e=document.getElementById("sidebar"),t=document.getElementById("sidebarOverlay"),n=document.getElementById("hamburgerMenu");if(e&&t){let a=document.body.getAttribute("data-sidebar-scroll-y")||0;document.body.classList.remove("sidebar-open"),document.documentElement.classList.remove("sidebar-open"),document.body.style.overflow="",document.documentElement.style.overflow="",document.body.style.position="",document.body.style.top="",document.body.style.width="",window.scrollTo(0,parseInt(a)),document.body.removeAttribute("data-sidebar-scroll-y"),e.classList.remove("open"),t.classList.remove("active"),n.classList.remove("active")}}function v(){let e=document.getElementById("sidebar");e&&e.classList.contains("open")?b():f()}let w=!1;function x(){let e=document.getElementById("sidebar-typewriter-text");if(!e||w)return;w=!0;let t=[["S","t","u","d","y","S","p","a","r","k"]],n=0,a=0,o=!0,i="";e.innerHTML='<span style="visibility: hidden;">A</span>',setTimeout(function s(){let l=t[n];if(o)if(a<l.length){i+=l[a];let t=0===n?"typewriter-text-pink":"typewriter-text-orange",o=0===n?"typewriter-cursor-blue":"typewriter-cursor-pink";e.innerHTML='<span class="'.concat(t,'">').concat(i,'</span><span class="').concat(o,'"></span>'),e.style.visibility="visible",a++,setTimeout(s,200)}else{let t=0===n?"typewriter-text-pink":"typewriter-text-orange";e.innerHTML='<span class="'.concat(t,'">').concat(i,"</span>"),setTimeout(()=>{o=!1,s()},2e3)}else if(a>0){if(a--,""===(i=l.slice(0,a).join("")))e.innerHTML='<span style="visibility: hidden;">A</span>';else{let t=0===n?"typewriter-text-pink":"typewriter-text-orange",a=0===n?"typewriter-cursor-blue":"typewriter-cursor-pink";e.innerHTML='<span class="'.concat(t,'">').concat(i,'</span><span class="').concat(a,'"></span>')}setTimeout(s,200)}else e.innerHTML='<span style="visibility: hidden;">A</span>',n=0,setTimeout(()=>{o=!0,i="",a=0,s()},1e3)},0)}function k(){function e(e){document.querySelectorAll(".sidebar-link").forEach(t=>{let n=t.textContent.trim();n===e?t.classList.add("active"):("My Batches"===n||"All Batches"===n)&&t.classList.remove("active")})}e("My Batches"),window.updateActiveSidebarLink=e;let t=document.getElementById("hamburgerMenu");t&&!t.hasAttribute("data-listener-attached")&&(t.setAttribute("data-listener-attached","true"),t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),v()}));let n=document.getElementById("sidebarOverlay");n&&!n.hasAttribute("data-listener-attached")&&(n.setAttribute("data-listener-attached","true"),n.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),b()})),document.querySelectorAll(".sidebar-link").forEach((t,n)=>{if(t.hasAttribute("data-listener-attached"))return;t.setAttribute("data-listener-attached","true");let a=t.getAttribute("href");a&&(a.startsWith("http")||a.startsWith("https"))||t.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation();let a=t.textContent.trim();"My Batches"===a?(e("My Batches"),b(),setTimeout(()=>{window.showFavoriteBatches()},100)):"All Batches"===a&&(e("All Batches"),b(),setTimeout(()=>{window.showAllBatches()},100))})})}function I(){(0,l.A)();let[e,t]=(0,o.J0)(!0);return(0,o.vJ)(()=>{sessionStorage.getItem("telegramPopupShown")||(m(),sessionStorage.setItem("telegramPopupShown","true"))},[]),(0,o.vJ)(()=>{window.VerifyScript&&window.VerifyScript.initVerification()},[]),(0,o.vJ)(()=>{"undefined"!=typeof document&&(document.title="StudySpark"),window.setIsInitialLoading=t},[]),(0,o.vJ)(()=>{let e=document.getElementById("telegramPopup"),t=document.querySelector(".popup-close");return document.getElementById("explore-btn"),document.getElementById("loading-overlay"),e&&t&&(e.style.zIndex="1000",!function(){let e=document.getElementById("typewriter-text");if(!e)return;let t=[["S","t","u","d","y","S","p","a","r","k"]],n=0,a=0,o=!0,i="";e.innerHTML='<span style="visibility: hidden;">A</span>',setTimeout(function s(){let l=t[n];if(o)if(a<l.length){i+=l[a];let t=0===n?"typewriter-text-pink":"typewriter-text-orange",o=0===n?"typewriter-cursor-blue":"typewriter-cursor-pink";e.innerHTML='<span class="'.concat(t,'">').concat(i,'</span><span class="').concat(o,'"></span>'),e.style.visibility="visible",a++,setTimeout(s,200)}else{let t=0===n?"typewriter-text-pink":"typewriter-text-orange";e.innerHTML='<span class="'.concat(t,'">').concat(i,"</span>"),setTimeout(()=>{o=!1,s()},2e3)}else if(a>0){if(a--,""===(i=l.slice(0,a).join("")))e.innerHTML='<span style="visibility: hidden;">A</span>';else{let t=0===n?"typewriter-text-pink":"typewriter-text-orange",a=0===n?"typewriter-cursor-blue":"typewriter-cursor-pink";e.innerHTML='<span class="'.concat(t,'">').concat(i,'</span><span class="').concat(a,'"></span>')}setTimeout(s,200)}else e.innerHTML='<span style="visibility: hidden;">A</span>',n=0,setTimeout(()=>{o=!0,i="",a=0,s()},1e3)},0)}(),t.addEventListener("click",()=>{h()}),window.addEventListener("click",t=>{t.target===e&&h()})),()=>{window.stopMainTypewriter&&window.stopMainTypewriter()}},[]),(0,o.vJ)(()=>{let e=!1,t=!1;function n(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function a(e){var t,n;return(null==(t=e.subjectId)?void 0:t.slug)?e.subjectId.slug:(null==(n=e.subject)?void 0:n.slug)?e.subject.slug:null}function o(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Video",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=new URLSearchParams({rc:t,pro:e,title:n});return a&&l.set("subject",a),o&&l.set("live","true"),i&&l.set("conversationId",i),s&&l.set("entityId",s),"".concat(o?"live-player":"player","?").concat(l.toString())}let i=document.getElementById("loadingOverlay"),s=document.getElementById("main"),l=document.getElementById("subjects");document.getElementById("chapters");let d=document.getElementById("backBtn"),m=document.getElementById("searchInput");document.getElementById("todayClasses");let h=[],y=1,g=!1,f="",b="",v="",x=1,I=1/0,E=!1,L=[],j=0,S=new Map,T=!1,N=new Map,C=!1,B=new Map,D=!1,M="",A="",U="LECTURES",_="lectures",H="",P=localStorage.getItem("currentTeacherImage")||"",q=!1,z=!0,F="";function R(){let e=localStorage.getItem("favoriteBatches");return e?JSON.parse(e):[]}let O=new Map,V=!1;async function Y(e){if(O.has(e))return O.get(e);if(V)return O.get(e)||[];try{V=!0,window.currentBatchId=e,window.currentBatchId!==e&&(S.clear(),N.clear(),O.clear());let t=document.getElementById("announcementsContainer");t&&(t.innerHTML="");let n=await fetch("".concat(c,"/batch/").concat(encodeURIComponent(e),"/todays-schedule?batchId=").concat(e,"&isNewStudyMaterialFlow=true")),a=await n.json();if(!a.data||!Array.isArray(a.data))return O.set(e,[]),[];return O.set(e,a.data),a.data}catch(t){return O.set(e,[]),[]}finally{V=!1}}async function W(e,t,n){let a=document.getElementById("lectureAttachmentsModal"),o=document.getElementById("lectureAttachmentsLoading"),i=document.getElementById("lectureAttachmentsContent"),s=document.getElementById("lectureAttachmentsError");if(a){a.style.display="flex",o.style.display="flex",i.style.display="none",s.style.display="none";try{let a=await fetch("".concat(c,"/batch/").concat(t,"/subject/").concat(n,"/schedule/").concat(e,"/schedule-details"));if(!a.ok)throw Error("Failed to fetch attachments");let s=await a.json();if(!s.success||!s.data)throw Error("Invalid attachments data");(function(e){let t=document.getElementById("lectureNotesContent"),n=document.getElementById("lectureDppContent");t.innerHTML="",n.innerHTML="",e.homeworkIds&&e.homeworkIds.length>0?e.homeworkIds.forEach(e=>{e.attachmentIds&&e.attachmentIds.length>0&&e.attachmentIds.forEach(n=>{let a=X(n.name,e.note||"Class Notes","".concat(n.baseUrl).concat(n.key));t.appendChild(a)})}):t.innerHTML='<div style="padding: 20px; text-align: center; color: #888;">No notes available</div>',e.dpp&&e.dpp.homeworkIds&&e.dpp.homeworkIds.length>0?e.dpp.homeworkIds.forEach(e=>{e.attachmentIds&&e.attachmentIds.length>0&&e.attachmentIds.forEach(t=>{let a=X(t.name,e.note||"DPP","".concat(t.baseUrl).concat(t.key));n.appendChild(a)})}):n.innerHTML='<div style="padding: 20px; text-align: center; color: #888;">No DPP available</div>',function(){let e=document.getElementById("lectureNotesHeader"),t=document.getElementById("lectureDppHeader"),n=document.getElementById("lectureNotesSection"),a=document.getElementById("lectureDppSection");e&&(e.onclick=()=>{n.classList.toggle("collapsed")}),t&&(t.onclick=()=>{a.classList.toggle("collapsed")})}()})(s.data),o.style.display="none",i.style.display="block"}catch(e){console.error("Error loading attachments:",e),o.style.display="none",s.style.display="block",s.querySelector("p").textContent=e.message||"Failed to load attachments"}}}function X(e,t,n){let a=document.createElement("div");return a.className="lecture-attachment-item",a.innerHTML='\n        <div class="lecture-attachment-item-icon">\n          <svg viewBox="0 0 24 24" fill="currentColor">\n            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z" />\n          </svg>\n        </div>\n        <div class="lecture-attachment-item-info">\n          <div class="lecture-attachment-item-title">'.concat(e,'</div>\n        </div>\n        <div class="lecture-attachment-item-download">\n          <svg viewBox="0 0 24 24" fill="currentColor">\n            <path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z" />\n          </svg>\n        </div>\n      '),a.addEventListener("click",()=>{window.open(n,"_blank")}),a}function J(){let e=document.getElementById("lectureAttachmentsModal");e&&(e.style.display="none")}function Z(e){return R().some(t=>t.id===e)}let G=!1;function Q(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(G)return;let a=R(),o=a.findIndex(t=>t.id===e);if(o>-1){let e=a[o].name||n||"Unknown Batch";a.splice(o,1),t&&(t.classList.remove("enrolled"),t.innerHTML='<i class="fas fa-star"></i> ENROLL'),et("You have been unenrolled from this batch!",!1,e)}else{if(a.length>=5)return void et("You can only enroll in up to 5 batches at a time!",!1,"Enrollment Limit");if(!n){var i;let e=null==t?void 0:t.closest(".card");n=(null==e||null==(i=e.querySelector(".card-title"))?void 0:i.textContent)||"Unknown Batch"}a.push({id:e,name:n}),t&&(t.classList.add("enrolled"),t.innerHTML='<i class="fas fa-star"></i> ENROLLED'),et("You are enrolled in this batch!",!0,n)}localStorage.setItem("favoriteBatches",JSON.stringify(a)),B.clear(),G=!0,setTimeout(()=>{G=!1},3300)}async function K(){let e=R();if(0===e.length)return[];let t=e.map(e=>e.id).sort().join(",");if(B.has(t))return B.get(t);if(D)return B.get(t)||[];try{D=!0;let n=e.map(e=>e.id).join(","),a="".concat(c,"/batches/favorite?ids=").concat(encodeURIComponent(n)),o=Math.floor(Date.now()/1e3),i=await fetch(a,{method:"GET",headers:{"X-Client-Info":o.toString(),Accept:"application/json"}}),s=await i.json();if(!s.success||!s.data)return B.set(t,[]),[];{let e=s.data.map(e=>({name:e.name,image:e.image||null,batchId:e._id,startDate:e.startDate,isFavorite:!0}));return B.set(t,e),e}}catch(e){return console.error("❌ Error fetching favorite batches:",e),B.set(t,[]),[]}finally{D=!1}}function $(){let e=localStorage.getItem("TOKEN"),t=localStorage.getItem("expires");if(e&&t)try{let e=1e3*parseInt(t),n=Date.now(),a=e-n;a>0&&setTimeout(()=>{ee(a)},2e3)}catch(e){console.error("Error checking token expiry:",e)}}function ee(e){let t=document.getElementById("tokenNotification"),n=Math.floor(e/36e5),a=Math.floor(e%36e5/6e4);document.getElementById("tokenTimeLeft").textContent=n>0?"".concat(n,"h ").concat(a,"m"):"".concat(a,"m"),t.style.display="block",setTimeout(()=>{t.classList.add("fade-out"),setTimeout(()=>{t.style.display="none",t.classList.remove("fade-out")},300)},5e3)}function et(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=document.getElementById("favoriteNotification"),o=document.getElementById("favoriteNotificationMessage"),i=document.getElementById("favoriteNotificationIcon"),s=document.getElementById("favoriteNotificationTitle");o.textContent=e,s&&n?s.textContent=n:s&&(s.textContent="Enrollment"),t?(i.style.color="#FFD700",i.style.filter="drop-shadow(0 0 8px rgba(255, 215, 0, 0.6))"):(i.style.color="#888",i.style.filter="drop-shadow(0 0 8px rgba(136, 136, 136, 0.6))"),a.style.display="block",a.classList.remove("fade-out"),setTimeout(()=>{a.classList.add("fade-out"),setTimeout(()=>{a.style.display="none",a.classList.remove("fade-out")},300)},3e3)}$();let en=!1,ea=[];function eo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"warning";if(en)return void ea.push({message:e,type:t});let n=document.getElementById("notificationPopup"),a=n.querySelector(".notification-message"),o=n.querySelector(".notification-icon");en=!0,a.textContent=e,"warning"===t?o.className="fas fa-exclamation-triangle notification-icon":"error"===t?o.className="fas fa-times-circle notification-icon":"success"===t&&(o.className="fas fa-check-circle notification-icon"),n.style.display="block",n.classList.remove("fade-out"),setTimeout(()=>{n.classList.add("fade-out"),setTimeout(()=>{if(n.style.display="none",en=!1,ea.length>0){let e=ea.shift();setTimeout(()=>{eo(e.message,e.type)},100)}},600)},3e3)}function ei(){er(),s.style.display="grid",d.style.display="none",F="",z=!0,eg="favorites",window.showFavoriteBatches()}function es(){let e=document.querySelector(".my-batch-menu-portal");e&&e.remove()}function el(e){i.style.display=e?"flex":"none"}function ec(e){er(),e.style.display="block"}function er(){es(),["main","subjects","chaptersDiv","lectureSection","todayWrapper"].forEach(e=>{let t=document.getElementById(e);t&&(t.style.display="none")});let e=document.getElementById("backBtn");e&&(e.style.display="block",e.onclick=ed);let t=document.getElementById("loadMoreBatchesWrapper");t&&t.remove(),window.stopMainTypewriter&&window.stopMainTypewriter()}function ed(){er();let e=new URLSearchParams(window.location.search),t=e.get("batch"),n=e.get("subject"),a=e.get("topic");t&&n&&a?(history.pushState({},"","?batch=".concat(t,"&subject=").concat(n)),ev(t,n)):t&&n?(history.pushState({},"","?batch=".concat(t)),loadSubjects(t,"live")):(t&&history.pushState({},"",window.location.pathname),er(),s.style.display="grid",d.style.display="none",F="",z=!0,"all"===eg?window.showAllBatches():(eg="favorites",window.showFavoriteBatches()))}function ep(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],h.push(e)}function ec(e){er(),e.style.display="lectureSection"===e.id?"block":"grid"}function eu(e,t,n,a,o){let i=document.createElement("div");i.className="card";let s=Z(a);i.innerHTML="\n        ".concat(n?'<img src="'.concat(n,'" alt="StudySpark" onerror="this.src=\'https://i.postimg.cc/Dz6pv5fT/studyspark.png\'; this.onerror=null;" loading="lazy" decoding="async" />'):'<img src="https://i.postimg.cc/Dz6pv5fT/studyspark.png" alt="StudySpark" loading="lazy" decoding="async" />','\n        <div class="card-title">').concat(t,'</div>\n        <div class="card-buttons">\n          <button class="enroll-button ').concat(s?"enrolled":"",'" data-batch-id="').concat(a,'" onclick="event.stopPropagation();">\n            <i class="fas fa-star"></i> ').concat(s?"ENROLLED":"ENROLL",'\n          </button>\n          <button class="study-button" onclick="event.stopPropagation();"><i class="fas fa-book-open"></i> STUDY</button>\n        </div>\n      '),i.querySelector(".study-button").onclick=e=>{e.stopPropagation(),o()};let l=i.querySelector(".enroll-button");l.onclick=e=>{e.stopPropagation(),Q(a,l)},e.appendChild(i)}async function em(){let{reset:e=!1,loadMore:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(q)return;if(t&&L.length>0){let e=L.slice(j,j+20);e.length>0&&(eh(e,{append:!0}),j+=e.length,z=j<L.length,ef());return}q=!0,e&&(L=[],j=0,s.innerHTML="",z=!0);let n=document.getElementById("chapterLoadMoreWrapper");n&&(n.style.display="none"),s.style.display="grid",el(!0);try{let t=[];if(e||0===L.length){if(F&&"batch"!==F.toLowerCase()){let e="".concat(c,"/batches/search?page=1&name=").concat(encodeURIComponent(F)),n=Math.floor(Date.now()/1e3),a=await fetch(e,{headers:{"X-Client-Info":n.toString(),"Content-Type":"application/json"}});t=((await a.json()).data||[]).map(e=>({name:e.name,image:e.image||null,batchId:e._id,startDate:e.startDate}))}else{let e=F?"&name=".concat(encodeURIComponent(F)):"",n="".concat(c,"/batches/search?page=1").concat(e),a=Math.floor(Date.now()/1e3),o=await fetch(n,{headers:{"X-Client-Info":a.toString(),"Content-Type":"application/json"}}),i=(await o.json()).data||[],s=t.map(e=>e.batchId),l=i.filter(e=>!s.includes(e._id)).map(e=>({name:e.name,image:e.image||null,batchId:e._id,startDate:e.startDate}));t=[...t,...l]}L=t,j=0}if(0===L.length)ey(),z=!1,setTimeout(()=>{el(!1)},800);else{let e=L.slice(0,20);j=e.length,eh(e,{append:!1}),el(!1),z=j<L.length,ef()}}catch(e){el(!1)}finally{q=!1}}function eh(e){let{append:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t||(s.innerHTML=""),todayWrapper.style.display="none",d.style.display="none",m.style.display="block";let n=document.getElementById("batchTabsWrapper");n&&(n.style.display="block"),e.forEach(e=>{eu(s,e.name,e.image,e.batchId,()=>{b=e.name,loadSubjects(e.batchId)})})}function ey(){s.innerHTML='\n        <div style="text-align:center; color:#666; padding:2rem;">\n          <p>\uD83D\uDD0D No batches found.</p>\n        </div>\n      '}window.showFavoriteBatches=async function(){history.pushState({},"",window.location.pathname),es(),er();let[e,t,n,a]=["main","searchInput","backBtn","todayWrapper"].map(e=>document.getElementById(e));t&&Object.assign(t.style,{display:"none",visibility:"hidden",opacity:"0",position:"absolute",left:"-9999px"}),n&&(n.style.display="none"),a&&(a.style.display="none"),eg="favorites",el(!0);try{let t=await K();if(t.length>0){if(e){var o;e.style.display="block",e.innerHTML='\n              <div id="myBatchesContainer" style="\n                max-width: 1200px;\n                margin: -50px auto;\n                padding: 20px;\n              ">\n                \x3c!-- Dropdown Menu Only --\x3e\n                <div id="batchDropdownWrapper" style="\n                  position: relative;\n                  max-width: 500px;\n                  margin: 0 auto 24px auto;\n                  z-index: 1;\n                ">\n                  <div class="my-batch-dropdown-portal">\n                    <div class="my-batch-btn" id="myBatchBtn">\n                      <span id="selectedBatchText">'.concat((null==(o=t[0])?void 0:o.name)||"No batches available",'</span>\n                      <i class="fas fa-chevron-down" id="batchArrow"></i>\n                    </div>\n                  </div>\n                </div>\n                \n                \x3c!-- Today\'s Schedule Section --\x3e\n                <div id="todayScheduleSection" style="display: none; background: linear-gradient(135deg, rgba(26, 26, 46, 0.95) 0%, rgba(22, 33, 62, 0.95) 100%); border-radius: 16px; padding: 24px; margin-bottom: 24px; border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(20px); box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);">\n                  <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">\n                    <h3 style="color: #fff; margin: 0; font-size: 1.4rem; font-weight: 600; display: flex; align-items: center; gap: 12px;">\n                      <i class="fas fa-calendar-day" style="color: #00d4ff;"></i>Today\'s Classes\n                    </h3>\n                  </div>\n                  <div id="todayClassesContent" style="display: flex; gap: 16px; min-height: 200px; overflow-x: auto; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch;">\n                    <div style="display: flex; align-items: center; justify-content: center; color: rgba(255, 255, 255, 0.6); text-align: center; font-size: 1rem; grid-column: 1 / -1;">Select a batch to see today\'s classes</div>\n                  </div>\n                </div>\n                \n                \x3c!-- View All Classes Section --\x3e\n                <div id="viewAllClassesSection" style="display: none; text-align: center; margin-top: 24px;">\n                  <button onclick="window.loadSubjects(window.currentBatchId, \'live\')" style="background: linear-gradient(135deg, #4652ff 0%, #5fbfff 50%, #00ddff 100%); color: white; border: none; padding: 16px 32px; font-size: 1.1rem; font-weight: 600; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; backdrop-filter: blur(10px); box-shadow: 0 4px 15px rgba(70, 82, 255, 0.3); border: 1px solid rgba(255, 255, 255, 0.1);" onmouseover="this.style.transform=\'translateY(-2px) scale(1.05)\'; this.style.boxShadow=\'0 8px 25px rgba(70, 82, 255, 0.4)\'" onmouseout="this.style.transform=\'translateY(0) scale(1)\'; this.style.boxShadow=\'0 4px 15px rgba(70, 82, 255, 0.3)\'">\n                    <i class="fas fa-th-large" style="margin-right: 8px;"></i>View All Classes\n                  </button>\n                </div>\n                \n                \x3c!-- Header Section with StudySpark Quote --\x3e\n                <div style="padding: 40px 20px; text-align: center; margin-top: 20px;">\n                  <h2 style="color: #ff1493; font-family: \'Inter\', \'Segoe UI\', -apple-system, BlinkMacSystemFont, sans-serif; font-size: 1.8rem; font-weight: 600; margin: 0 0 12px 0; letter-spacing: 0.8px; text-shadow: 0 0 25px rgba(255, 20, 147, 0.8), 0 0 50px rgba(255, 20, 147, 0.6), 0 0 75px rgba(255, 20, 147, 0.4), 0 0 100px rgba(255, 20, 147, 0.2); animation: glow-pulse 3s ease-in-out infinite alternate;">Padhlo chahe kahi se Manzil milegi yahi se!</h2>\n                  <p class="studyspark-text" style="color: #ffffff; font-family: \'Inter\', \'Segoe UI\', -apple-system, BlinkMacSystemFont, sans-serif; font-size: 1rem; font-weight: 500; margin: 0; display: flex; align-items: center; justify-content: center; gap: 8px; text-shadow: 0 0 15px rgba(255, 255, 255, 0.5), 0 0 30px rgba(255, 255, 255, 0.3);">\n                    <span style="color: #ffffff; font-size: 1.1rem; text-shadow: 0 0 15px rgba(255, 0, 0, 0.6), 0 0 30px rgba(255, 255, 255, 0.4), 0 0 45px rgba(255, 255, 255, 0.2); animation: heart-beat 2s ease-in-out infinite;">\uD83D\uDC9D</span> From StudySpark\n                  </p>\n                </div>\n              </div>\n            ');let n=document.createElement("div");n.className="my-batch-menu-portal",n.style.display="none",n.innerHTML=t.map((e,t)=>'\n                <div class="my-batch-option" data-batch-id="'.concat(e.batchId,'" data-batch-name="').concat(e.name,'" ').concat(0===t?'data-selected="true"':"",'>\n                  <span class="batch-option-name" style="flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">').concat(e.name,'</span>\n                  <button class="unenroll-btn" data-batch-id="').concat(e.batchId,'" data-batch-name="').concat(e.name,'" style="\n                    background: rgba(255, 68, 68, 0.15);\n                    color: #ff4444;\n                    border: 1px solid rgba(255, 68, 68, 0.3);\n                    padding: 4px 12px;\n                    font-size: 0.75rem;\n                    font-weight: 600;\n                    border-radius: 6px;\n                    cursor: pointer;\n                    transition: all 0.2s ease;\n                    white-space: nowrap;\n                    margin-left: 8px;\n                  ">Unenroll</button>\n                </div>\n              ')).join(""),document.body.appendChild(n);let[a,i,s]=["myBatchBtn","batchArrow","selectedBatchText"].map(e=>document.getElementById(e));if(a.onclick=e=>{if(e.stopPropagation(),"block"===n.style.display)n.style.display="none",i.style.transform="rotate(0deg)";else{let e=a.getBoundingClientRect();Object.assign(n.style,{display:"block",top:e.bottom+4+"px",left:e.left+"px",width:e.width+"px"}),i.style.transform="rotate(180deg)"}},document.onclick=e=>{a.contains(e.target)||n.contains(e.target)||(n.style.display="none",i.style.transform="rotate(0deg)")},n.querySelectorAll(".unenroll-btn").forEach(e=>{e.addEventListener("mouseenter",function(){this.style.background="rgba(255, 68, 68, 0.25)",this.style.borderColor="rgba(255, 68, 68, 0.5)",this.style.transform="scale(1.05)"}),e.addEventListener("mouseleave",function(){this.style.background="rgba(255, 68, 68, 0.15)",this.style.borderColor="rgba(255, 68, 68, 0.3)",this.style.transform="scale(1)"}),e.addEventListener("click",function(e){e.stopPropagation();let t=this.dataset.batchId,a=this.dataset.batchName,o=R(),s=o.findIndex(e=>e.id===t);s>-1&&(o.splice(s,1),localStorage.setItem("favoriteBatches",JSON.stringify(o)),B.clear(),et("Unenrolled from ".concat(a),!1,a),n.style.display="none",i.style.transform="rotate(0deg)",setTimeout(()=>{window.showFavoriteBatches()},500))})}),n.onclick=e=>{let t=e.target.closest(".my-batch-option");!e.target.closest(".unenroll-btn")&&t&&(s.textContent=t.dataset.batchName,n.querySelectorAll(".my-batch-option").forEach(e=>e.removeAttribute("data-selected")),t.setAttribute("data-selected","true"),n.style.display="none",i.style.transform="rotate(0deg)",window.handleBatchSelection({target:{value:t.dataset.batchId}}))},t.length>0){let e=document.getElementById("todayClassesContent");e&&(e.innerHTML='<div style="display:flex;align-items:center;justify-content:center;padding:40px;color:rgba(255,255,255,0.6)"><div><div class="loader"></div><div>Loading today\'s classes...</div></div></div>'),setTimeout(()=>window.handleBatchSelection({target:{value:t[0].batchId}}),100)}}}else e&&(e.style.display="grid",e.innerHTML='\n              <div style="grid-column: 1 / -1; text-align: center; color: rgba(255, 255, 255, 0.6); padding: 3rem; background: rgba(26, 26, 46, 0.95); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1);">\n                <i class="fas fa-star" style="font-size: 3rem; color: var(--squid-pink); margin-bottom: 1rem;"></i>\n                <h3 style="color: #fff; margin-bottom: 0.5rem;">No Enrolled Batches</h3>\n                <p style="margin: 0 0 1.5rem 0; font-size: 1rem;">Get enroll in batch by clicking on enroll button in all batches tab</p>\n                <button id="exploreBatchesBtn" onclick="window.switchBatchTab(\'all\')" style="background: linear-gradient(135deg, #4652ff 0%, #5fbfff 50%, #00ddff 100%); color: white; border: none; padding: 16px 32px; font-size: 1.1rem; font-weight: 600; border-radius: 12px; cursor: pointer; transition: all 0.3s ease; backdrop-filter: blur(10px); box-shadow: 0 4px 15px rgba(70, 82, 255, 0.3); border: 1px solid rgba(255, 255, 255, 0.1);" onmouseover="this.style.transform=\'translateY(-2px) scale(1.05)\'; this.style.boxShadow=\'0 8px 25px rgba(70, 82, 255, 0.4)\'" onmouseout="this.style.transform=\'translateY(0) scale(1)\'; this.style.boxShadow=\'0 4px 15px rgba(70, 82, 255, 0.3)\'">\n                  <i class="fas fa-search" style="margin-right: 8px;"></i>Explore Batches\n                </button>\n              </div>\n              \n              \x3c!-- Header Section with StudySpark Quote --\x3e\n              <div style="grid-column: 1 / -1; padding: 40px 20px; text-align: center; margin-top: 20px;">\n                <h2 style="color: #ff1493; font-family: \'Inter\', \'Segoe UI\', -apple-system, BlinkMacSystemFont, sans-serif; font-size: 1.8rem; font-weight: 600; margin: 0 0 12px 0; letter-spacing: 0.8px; text-shadow: 0 0 25px rgba(255, 20, 147, 0.8), 0 0 50px rgba(255, 20, 147, 0.6), 0 0 75px rgba(255, 20, 147, 0.4), 0 0 100px rgba(255, 20, 147, 0.2); animation: glow-pulse 3s ease-in-out infinite alternate;">Padhlo chahe kahi se Manzil milegi yahi se!</h2>\n                <p style="color: #ffffff; font-family: \'Inter\', \'Segoe UI\', -apple-system, BlinkMacSystemFont, sans-serif; font-size: 1rem; font-weight: 500; margin: 0; display: flex; align-items: center; justify-content: center; gap: 8px; text-shadow: 0 0 15px rgba(255, 255, 255, 0.5), 0 0 30px rgba(255, 255, 255, 0.3);">\n                  <span style="color: #ffffff; font-size: 1.1rem; text-shadow: 0 0 15px rgba(255, 255, 255, 0.6), 0 0 30px rgba(255, 255, 255, 0.4), 0 0 45px rgba(255, 255, 255, 0.2); animation: heart-beat 2s ease-in-out infinite;">\uD83E\uDD0D</span> From StudySpark\n                </p>\n              </div>\n            ')}catch(t){console.error("Error loading favorite batches:",t),e&&(e.style.display="grid",e.innerHTML='\n            <div style="grid-column: 1 / -1; text-align: center; color: rgba(255, 255, 255, 0.6); padding: 2rem;">\n              <p>Error loading favorite batches. Please try again.</p>\n            </div>\n            \n            \x3c!-- Header Section with StudySpark Quote --\x3e\n            <div style="grid-column: 1 / -1; padding: 40px 20px; text-align: center; margin-top: 20px;">\n              <h2 style="color: #ff1493; font-family: \'Inter\', \'Segoe UI\', -apple-system, BlinkMacSystemFont, sans-serif; font-size: 1.8rem; font-weight: 600; margin: 0 0 12px 0; letter-spacing: 0.8px; text-shadow: 0 0 25px rgba(255, 20, 147, 0.8), 0 0 50px rgba(255, 20, 147, 0.6), 0 0 75px rgba(255, 20, 147, 0.4), 0 0 100px rgba(255, 20, 147, 0.2); animation: glow-pulse 3s ease-in-out infinite alternate;">\n                Padhlo chahe kahi se Manzil milegi yahi se!\n              </h2>\n              <p style="color: #ffffff; font-family: \'Inter\', \'Segoe UI\', -apple-system, BlinkMacSystemFont, sans-serif; font-size: 1rem; font-weight: 500; margin: 0; display: flex; align-items: center; justify-content: center; gap: 8px; text-shadow: 0 0 15px rgba(255, 255, 255, 0.5), 0 0 30px rgba(255, 255, 255, 0.3);">\n                <span style="color: #ffffff; font-size: 1.1rem; text-shadow: 0 0 15px rgba(255, 255, 255, 0.6), 0 0 30px rgba(255, 255, 255, 0.4), 0 0 45px rgba(255, 255, 255, 0.2); animation: heart-beat 2s ease-in-out infinite;">\uD83E\uDD0D</span> From StudySpark\n              </p>\n            </div>\n          ')}finally{el(!1),ef()}},window.showAllBatches=function(){es(),er();let e=document.getElementById("main"),t=document.getElementById("searchInput"),n=document.getElementById("backBtn");e&&(e.style.display="grid"),t&&(t.style.display="block"),n&&(n.style.display="none"),F="",t&&(t.value=""),eg="all",em({reset:!0})};let eg="all";function ef(){let e=document.getElementById("loadMoreBatchesWrapper");e&&e.remove();let t=!1;if("all"===eg?t=z&&"none"!==s.style.display:"favorites"===eg&&(t=!1),t){let e=document.createElement("div");e.id="loadMoreBatchesWrapper",e.style.cssText="text-align: center; margin: 20px 0; padding: 20px;";let t=document.createElement("button");t.className="load-more-btn",t.textContent="Load More Batches",t.style.cssText="\n          background: linear-gradient(135deg, #0088cc, #229ED9);\n          color: white;\n          border: 3px solid rgba(255, 255, 255, 0.2);\n          padding: 12px 24px;\n          border-radius: 25px;\n          font-size: 16px;\n          font-weight: 600;\n          cursor: pointer;\n          transition: all 0.3s ease;\n          box-shadow: 0 4px 15px rgba(0, 136, 204, 0.3);\n        ",t.addEventListener("mouseenter",()=>{t.style.transform="translateY(-2px)",t.style.boxShadow="0 6px 20px rgba(0, 136, 204, 0.4)"}),t.addEventListener("mouseleave",()=>{t.style.transform="translateY(0)",t.style.boxShadow="0 4px 15px rgba(0, 136, 204, 0.3)"}),t.onclick=()=>{q||"all"!==eg||em({loadMore:!0})},e.appendChild(t),s.parentNode.insertBefore(e,s.nextSibling)}}function eh(e){let{append:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t||(s.innerHTML=""),todayWrapper.style.display="none",d.style.display="none";let n=document.getElementById("searchInput");n&&("favorites"===eg?(n.style.visibility="hidden",n.style.position="absolute",n.style.top="-9999px",n.style.left="-9999px",n.style.opacity="0",n.style.pointerEvents="none"):(n.style.visibility="visible",n.style.position="relative",n.style.top="auto",n.style.left="auto",n.style.opacity="1",n.style.pointerEvents="auto"));let a=document.getElementById("batchTabsWrapper");a&&(a.style.display="block"),e.forEach(e=>{eu(s,e.name,e.image,e.batchId,()=>{b=e.name,loadSubjects(e.batchId)})})}function eb(e,t){let n;return function(){for(var a=arguments.length,o=Array(a),i=0;i<a;i++)o[i]=arguments[i];clearTimeout(n),n=setTimeout(()=>e(...o),t)}}async function ev(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"UNITS",o=document.getElementById("chaptersDiv");if(!n){let e=document.getElementById("chapterLoadMoreWrapper");e&&e.remove(),y=1}if(g)return;n||(history.pushState({},"","?batch=".concat(e,"&subject=").concat(t)),o.innerHTML='\n          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; padding: 16px 16px 10px 16px; border-bottom: 2px solid var(--border-color, rgba(255, 255, 255, 0.1));">\n            <button id="topic-tab-chapters" class="topic-tab '.concat("UNITS"===a?"active":"",'" style="\n              padding: 12px 16px;\n              background: ').concat("UNITS"===a?"linear-gradient(135deg, #0088cc, #229ED9)":"var(--card-bg, rgba(0, 0, 0, 0.12))",";\n              border: 2px solid ").concat("UNITS"===a?"#0088cc":"var(--border-color, rgba(0, 0, 0, 0.25))",";\n              border-radius: 8px;\n              color: ").concat("UNITS"===a?"white":"var(--text-primary, #000)",';\n              font-weight: 600;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              white-space: nowrap;\n            ">\n              <i class="fas fa-book-open" style="margin-right: 8px;"></i>Chapters\n            </button>\n            <button id="topic-tab-study" class="topic-tab ').concat("STUDY_MATERIAL"===a?"active":"",'" style="\n              padding: 12px 16px;\n              background: ').concat("STUDY_MATERIAL"===a?"linear-gradient(135deg, #0088cc, #229ED9)":"var(--card-bg, rgba(0, 0, 0, 0.12))",";\n              border: 2px solid ").concat("STUDY_MATERIAL"===a?"#0088cc":"var(--border-color, rgba(0, 0, 0, 0.25))",";\n              border-radius: 8px;\n              color: ").concat("STUDY_MATERIAL"===a?"white":"var(--text-primary, #000)",';\n              font-weight: 600;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              white-space: nowrap;\n            ">\n              <i class="fas fa-graduation-cap" style="margin-right: 8px;"></i>Study Material\n            </button>\n          </div>\n          <div id="topicsContainer" class="card-grid"></div>\n        '),document.getElementById("topic-tab-chapters").addEventListener("click",()=>{ev(e,t,!1,"UNITS")}),document.getElementById("topic-tab-study").addEventListener("click",()=>{ev(e,t,!1,"STUDY_MATERIAL")}),er(),document.getElementById("subjects").style.display="none",m.style.display="none"),g=!0,el(!0),f=e;let i=t;try{let e=Math.floor(Date.now()/1e3),n=await fetch("".concat(c,"/batch/").concat(f,"/details"),{headers:{"X-Client-Info":e.toString(),"Content-Type":"application/json"}}),a=await n.json(),o=a.data&&a.data.subjects||[],s=o.find(e=>e._id===t);!s&&(s=o.find(e=>e.slug===t||e.subjectSlug===t||e.subject.toLowerCase().replace(/[^a-z0-9]+/g,"-")===t))&&(i=s._id),H=i,s&&(v=s.slug||s.subjectSlug||s.subject.toLowerCase().replace(/[^a-z0-9]+/g,"-"))}catch(e){console.error("Error fetching subject details:",e),H=t}try{var s,l;let o=await fetch("".concat(c,"/batch/").concat(e,"/subject/").concat(i,"/topics?page=").concat(y,"&batchTagType=").concat(a)),d=await o.json(),p=d.data||[],u=(null==(s=d.paginate)?void 0:s.totalCount)||0,m=(null==(l=d.paginate)?void 0:l.limit)||20,h=Math.ceil(u/m),g=y<h,f=document.getElementById("topicsContainer");if(n||0!==p.length){if(n){let e=document.getElementById("chapterLoadMoreWrapper");e&&e.remove()}if(p.forEach(n=>{let o=document.createElement("div");o.className="chapter-card";let i=n.name.match(/^(Ch[-\s]*\d+|Chapter[-\s]*\d+|\d+)/i),s=i?i[0]:null,l=s?n.name.replace(/^(Ch[-\s]*\d+|Chapter[-\s]*\d+|\d+)\s*[:：-]?\s*/i,"").trim():n.name,c=n.lectureVideos||0,r=n.exercises||0,d=n.notes||0;o.innerHTML="\n          ".concat(s?'<div class="chapter-number-badge">'.concat(s,"</div>"):"",'\n          <div class="chapter-title">').concat(l,'</div>\n          <div class="chapter-meta">\n            <div><i class="fas fa-video"></i> ').concat(c," Lectures</div>\n            ").concat("STUDY_MATERIAL"===a?'<div><i class="fas fa-file-alt"></i> '.concat(d," Notes</div>"):'<div><i class="fas fa-book"></i> '.concat(r," DPPs</div>"),"\n          </div>\n        "),o.dataset.chapterId=n._id,o.dataset.chapterSlug=n.slug||n._id,o.dataset.totalLectures=c,o.dataset.totalDpps=r,o.addEventListener("click",()=>{if(!n._id)return void alert("Chapter ID missing. Cannot load lectures.");ep(()=>ev(e,t)),n.name;let a=n.slug||n.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),o=n._id;_="lectures",["lectures","notes","dppnotes","dpplecture"].forEach(e=>{let t=document.getElementById("tab-"+e);t&&t.classList.remove("active")});let i=document.getElementById("tab-lectures");i&&i.classList.add("active"),ex(e,t,a,"LECTURES",o)}),f.appendChild(o)}),el(!1),!n&&p.length>0&&(async()=>{try{let t=Math.floor(Date.now()/1e3),n=p.map(e=>({_id:e._id,slug:e.slug||e._id})),o=await fetch("".concat(c,"/batch/").concat(e,"/subject/").concat(v,"/chapter-completion-counts"),{method:"POST",headers:{"X-Client-Info":t.toString(),"Content-Type":"application/json"},body:JSON.stringify({chapters:n})}),i=await o.json();if(i.success&&Array.isArray(i.data)){let e=r();i.data.forEach(t=>{let n=document.querySelector('.chapter-card[data-chapter-id="'.concat(t.chapterId,'"]'));if(!n)return;let o=parseInt(n.dataset.totalLectures)||0,i=parseInt(n.dataset.totalDpps)||0,s=0,l=0;t.data.lectures.forEach(t=>{e.includes(t.lectureId)&&s++,t.dppScheduleId&&t.dppHomeworkIds.length>0&&t.dppHomeworkIds.forEach(n=>{let a=t.dppScheduleId+"_".concat(n);e.includes(a)&&l++})});let c=n.querySelector(".chapter-meta");if(c){var r,d;let e=(null==(d=n.querySelector(".chapter-meta div:nth-child(2)"))||null==(r=d.textContent.match(/\d+/))?void 0:r[0])||0;c.innerHTML='\n                        <div><i class="fas fa-video"></i> '.concat(s,"/").concat(o," Lectures</div>\n                        ").concat("STUDY_MATERIAL"===a?'<div><i class="fas fa-file-alt"></i> '.concat(e," Notes</div>"):'<div><i class="fas fa-book"></i> '.concat(l,"/").concat(i," DPPs</div>"),"\n                      ")}})}}catch(e){console.error("Error fetching chapter completion counts:",e)}})(),g){let n=document.createElement("div");n.id="chapterLoadMoreWrapper",n.style.cssText="text-align: center; margin: 20px 0; padding: 20px;";let o=document.createElement("button");o.className="load-more-btn",o.innerHTML='\n              <i class="fas fa-plus-circle" style="margin-right: 8px;"></i>\n              Load More '.concat("UNITS"===a?"Chapters":"Study Materials","\n            "),o.style.cssText="\n              background: linear-gradient(135deg, #0088cc, #229ED9);\n              color: white;\n              border: 3px solid rgba(255, 255, 255, 0.2);\n              padding: 12px 24px;\n              border-radius: 25px;\n              font-size: 14px;\n              font-weight: 600;\n              cursor: pointer;\n              transition: all 0.3s ease;\n              box-shadow: \n                0 4px 20px rgba(0, 136, 204, 0.4),\n                0 8px 40px rgba(0, 136, 204, 0.2);\n              position: relative;\n              overflow: hidden;\n            ",o.addEventListener("click",async()=>{y++,n.remove(),await ev(e,t,!0,a)}),o.addEventListener("mouseenter",()=>{o.style.transform="scale(1.05) translateY(-2px)",o.style.boxShadow="\n                0 6px 25px rgba(0, 136, 204, 0.6),\n                0 12px 50px rgba(0, 136, 204, 0.3)\n              ",o.style.background="linear-gradient(135deg, #229ED9, #0088cc)"}),o.addEventListener("mouseleave",()=>{o.style.transform="scale(1) translateY(0)",o.style.boxShadow="\n                0 4px 20px rgba(0, 136, 204, 0.4),\n                0 8px 40px rgba(0, 136, 204, 0.2)\n              ",o.style.background="linear-gradient(135deg, #0088cc, #229ED9)"}),n.appendChild(o),f.parentNode.insertBefore(n,f.nextSibling)}}else f.innerHTML='<div style="color: var(--text-primary, #000); padding: 20px; text-align: center; background: var(--card-bg, rgba(0, 0, 0, 0.08)); border-radius: 12px; margin: 10px; border: 1px solid var(--border-color, rgba(0, 0, 0, 0.15)); font-size: 0.9rem;">\n            <i class="fas fa-'.concat("UNITS"===a?"book-open":"graduation-cap",'" style="margin-right: 8px; opacity: 0.8; color: var(--text-primary, #000);"></i>\n            No ').concat("UNITS"===a?"chapters":"study materials"," found.\n          </div>"),el(!1)}catch(t){console.error("Failed to load chapters:",t);let e=document.createElement("div");e.className="error-state",e.innerText="Failed to load chapters. Please try again.",o.appendChild(e),el(!1)}finally{ec(o),g=!1}}function ew(e){U=({lectures:"LECTURES",notes:"ALL",dppnotes:"ALL",dpplecture:"ALL"})[e]||"LECTURES",_=e,["lectures","notes","dppnotes","dpplecture"].forEach(e=>{let t=document.getElementById("tab-"+e);t&&t.classList.remove("active")});let t=document.getElementById("tab-"+e);t&&t.classList.add("active"),ex(f,v,M,U)}async function ex(e,t,a){let i,s,l,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"LECTURES",d=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,h=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(E)return;if(E=!0,!h){let n=document.getElementById("contentLoadMoreWrapper");n&&n.remove(),x=1,I=1/0;let o=new URLSearchParams({batch:e,subject:t,topic:a,type:r});d&&o.set("tag",d),history.pushState({},"","?".concat(o.toString())),document.getElementById("lectureContent").innerHTML="",m.style.display="none";let i=document.getElementById("chapterLoadMoreWrapper");i&&(i.style.display="none")}if(ec(document.getElementById("lectureSection")),el(!0),f=e,v=t,M=a,A=d,U=r,!H&&f&&v)try{let e=Math.floor(Date.now()/1e3),t=await fetch("".concat(c,"/batch/").concat(f,"/details"),{headers:{"X-Client-Info":e.toString(),"Content-Type":"application/json"}}),n=await t.json(),a=n.data&&n.data.subjects||[],o=a.find(e=>e._id===v);o||(o=a.find(e=>(e.slug||e.subjectSlug||e.subject.toLowerCase().replace(/[^a-z0-9]+/g,"-"))===v)),o&&o._id&&(H=o._id,v=o.slug||o.subjectSlug||o.subject.toLowerCase().replace(/[^a-z0-9]+/g,"-"))}catch(e){console.error("Error fetching subject details:",e)}let y=_||"lectures";try{let r=Math.floor(Date.now()/1e3);i="".concat(c,"/batch/").concat(e,"/subject/").concat(t,"/contents?page=").concat(x,"&contentType=").concat({lectures:"videos",notes:"notes",dppnotes:"DppNotes",dppvideos:"DppVideos",dpplecture:"DppVideos"}[y]||"videos"),null!==d&&(i+="&tag=".concat(a));let m=await fetch(i,{headers:{"X-Client-Info":r.toString(),"Content-Type":"application/json"}});l=(s=await m.json()).data||s.results||[];let g=document.getElementById("lectureContent");if(!Array.isArray(l)||0===l.length){h||(g.innerHTML="lectures"===y?'<div class="content-placeholder"><i class="fas fa-video"></i> No lectures available for this chapter.</div>':'<div class="content-placeholder"><i class="fas fa-folder-open"></i> No content found for this type.</div>'),el(!1),E=!1;return}let b=[];"lectures"===y?l.forEach(e=>{b.push({type:"LECTURE",_id:e._id,data:e,scheduleId:e._id,isMainLecture:!0,topic:e.topic,videoDetails:e.videoDetails,date:e.date||e.startTime,startTime:e.startTime,homeworkIds:e.homeworkIds||[]})}):l.forEach(e=>{b.push({type:"LECTURE",_id:e._id,data:e,scheduleId:e._id,isMainLecture:!0}),e.homeworkIds&&e.homeworkIds.length>0&&e.homeworkIds.forEach(t=>{b.push({type:"DPP",_id:t._id,data:e,homework:t,scheduleId:e._id,isDPP:!0,parentLectureId:e._id})})}),"lectures"===y?(async()=>{let e=b.map(e=>e._id),t={};try{let n=await fetch("".concat(c,"/batch/").concat(f,"/subject/").concat(v,"/batch-schedule-details"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scheduleIds:e})});if(n.ok){let e=await n.json();e.success&&e.data&&e.data.forEach(e=>{t[e.scheduleId]=e.data})}}catch(e){console.error("Error fetching batch schedule details:",e)}b.forEach(e=>{let a=document.createElement("div");a.className="lecture-wrapper",a.setAttribute("data-schedule-id",e._id);let i=document.createElement("div");i.className="lecture-card";let s=e.data||e,l=s.videoDetails||s,c=s.topic||l.name||"Untitled Lecture",r=P||l.image||"",d=l.duration||"00:00:00",m=s.date||s.startTime||l.createdAt,h=new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),y=e._id||e.id,b=p(y),x=n()?'crossorigin="anonymous"':"";i.innerHTML='\n              <div class="lecture-card-inner">\n                <div class="lecture-thumbnail-square">\n                  <img src="'.concat(r,'" alt="Lecture Thumbnail" onerror="this.src=\'https://i.postimg.cc/Dz6pv5fT/studyspark.png\'; this.onerror=null;" class="lecture-image-square" ').concat(x,' decoding="async" />\n                  <div class="lecture-duration-badge">').concat(d,'</div>\n                </div>\n                <div class="lecture-content-area">\n                  <div class="lecture-completion-button ').concat(b?"completed":"",'" data-lecture-id="').concat(y,'">\n                    <i class="fas fa-check"></i>\n                  </div>\n                  <div class="lecture-info-wrapper">\n                    <div class="lecture-header">\n                      <span class="lecture-type-date">LECTURE • ').concat(h,'</span>\n                    </div>\n                    <h3 class="lecture-title-new">').concat(c,'</h3>\n                  </div>\n                  <div class="lecture-action-buttons">\n                    <button class="lecture-view-btn">\n                      <i class="fas fa-play"></i>\n                      View Lecture\n                    </button>\n                    <button class="lecture-notes-btn">\n                      <i class="fas fa-file-alt"></i>\n                    </button>\n                    <button class="lecture-download-btn">\n                      <i class="fas fa-download"></i>\n                    </button>\n                  </div>\n                </div>\n              </div>\n            '),b&&i.classList.add("completed");let k=i.querySelector(".lecture-view-btn");k&&(k.onclick=async t=>{t.stopPropagation(),el(!0);try{let t=e._id,n=f;if(!t||!n)throw Error("Missing video ID or batch ID.");let a=o(t,n,e.topic||"Video Lecture",v);window.location.href=a}catch(e){alert("⚠️ Failed to load video.")}finally{el(!1)}});let I=i.querySelector(".lecture-notes-btn");I&&(I.onclick=t=>{t.stopPropagation(),W(e._id,f,v)});let E=i.querySelector(".lecture-download-btn");E&&(E.onclick=t=>{t.stopPropagation(),w(e._id,f,c)});let L=i.querySelector(".lecture-completion-button");L&&(L.onclick=e=>{e.stopPropagation(),u(y,"lecture",L,i)}),a.appendChild(i);let j=t[e._id];j&&j.dpp&&j.dpp.homeworkIds&&j.dpp.homeworkIds.forEach(e=>{let t=document.createElement("div");t.className="dpp-card-nested";let n=e.topic||e.note||"DPP",o=j.dpp._id+"_".concat(e._id),i=p(o);t.innerHTML='\n                    <div class="dpp-nested-inner '.concat(i?"completed":"",'">\n                      <div class="dpp-nested-icon">\n                        <i class="fas fa-file-alt"></i>\n                      </div>\n                      <div class="dpp-nested-content">\n                        <div class="dpp-nested-title">').concat(n,'</div>\n                      </div>\n                      <div class="dpp-nested-check ').concat(i?"completed":"",'" data-dpp-id="').concat(o,'" onclick="event.stopPropagation(); toggleDppCompletion(\'').concat(o,'\', this);" title="Mark as complete">\n                        <i class="fas fa-check-circle"></i>\n                      </div>\n                    </div>\n                  '),t.onclick=t=>{t.stopPropagation();try{e.attachmentIds&&e.attachmentIds.length>0?e.attachmentIds.forEach(e=>{let t="".concat(e.baseUrl).concat(e.key);window.open(t,"_blank")}):alert("No DPP attachments available.")}catch(e){console.error("Error opening DPP:",e),alert("Error opening DPP. Please try again.")}},a.appendChild(t)}),g.appendChild(a)}),el(!1)})():b.forEach(e=>{if(("notes"===y||"dppnotes"===y)&&e.isMainLecture&&!e.homework)return;let t=document.createElement("div");t.className="card";let a="Untitled";if("notes"===y||"dppnotes"===y){if(e.title)a=e.title;else if(e.homework){let t=e.homework;t.topic?a=t.topic:t.name?a=t.name:t.title&&(a=t.title)}}else{let t=e.data||e;t.name?a=t.name:t.title?a=t.title:t.topic?a=t.topic:e.name?a=e.name:e.title?a=e.title:e.topic&&(a=e.topic)}if("notes"===y||"dppnotes"===y){let n=e.scheduleId||e._id,o="notes"===y,i=o?"note-content":"dpp-content",s=n+(e.homework?"_".concat(e.homework._id||e.homework.id):""),l=p(s);t.className=(o?"note-card":"dpp-card")+(l?" completed":""),t.innerHTML='\n    <div class="'.concat("note-content"===i?"note-card-content":"dpp-card-content",'" ').concat(l?'data-completed="true"':"",'>\n      <div class="').concat(o?"note-icon":"dpp-icon",'">\n        ').concat(o?"\uD83D\uDCDD":"\uD83D\uDCCB",'\n      </div>\n      <div class="').concat(i,'">\n        <div class="').concat(o?"note-title":"dpp-title",'">').concat(a,'</div>\n        <div class="').concat(o?"note-label":"dpp-label",'">').concat(o?"NOTE":"DPP","</div>\n      </div>\n      ").concat(o?'<div class="'.concat(o?"note-arrow":"dpp-arrow",'"><i class="fas fa-chevron-right"></i></div>'):'<div class="dpp-completion-button '.concat(l?"completed":"",'" onclick="event.stopPropagation(); toggleDppCompletion(\'').concat(s,'\', this);" title="Mark as complete"><i class="fas fa-check"></i></div>'),"\n    </div>\n  "),t.onclick=async()=>{try{var t;el(!0);let n=e.scheduleId||e._id,a=v,o=null==(t=e.homework)?void 0:t._id,i=await fetch("".concat(c,"/batch/").concat(f,"/subject/").concat(H,"/attachment-links?scheduleId=").concat(n,"&subjectSlug=").concat(a)),s=await i.json();if(s.success&&s.data&&s.data.length>0){let t=o?s.data.filter(t=>{var n;return null==(n=e.homework.attachmentIds)?void 0:n.some(e=>e._id===t._id)}):s.data;t.length>0?t.forEach(e=>{e.url&&window.open(e.url,"_blank")}):e.homework&&e.homework.attachmentIds&&e.homework.attachmentIds.length>0?e.homework.attachmentIds.forEach(e=>{if(e.baseUrl&&e.key){let t="".concat(e.baseUrl).concat(e.key);window.open(t,"_blank")}}):alert("No attachments found for this item.")}else e.homework&&e.homework.attachmentIds&&e.homework.attachmentIds.length>0?e.homework.attachmentIds.forEach(e=>{if(e.baseUrl&&e.key){let t="".concat(e.baseUrl).concat(e.key);window.open(t,"_blank")}}):alert("No attachments found for this item.")}catch(e){console.error("Error loading attachments:",e),alert("Error loading attachments. Please try again.")}finally{el(!1)}}}else{var i,s,l,r,d;let a=e.data||e;a.videoDetails;let c=a.topic||(null==(i=a.videoDetails)?void 0:i.name)||"Untitled Video",m=(null==(s=a.videoDetails)?void 0:s.image)||"",h=(null==(l=a.videoDetails)?void 0:l.videoUrl)||a.url||"",y=(null==(r=a.videoDetails)?void 0:r.duration)||"00:00:00",g=a.date||a.startTime||(null==(d=a.videoDetails)?void 0:d.createdAt),b=new Date(g).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});t.className="lecture-card";let w=n()?'crossorigin="anonymous"':"",x=e._id||e.id,k=p(x);t.innerHTML='\n    <div class="lecture-card-inner">\n      \x3c!-- Left: Square Thumbnail --\x3e\n      <div class="lecture-thumbnail-square">\n        <img src="'.concat(m,'" alt="Lecture Thumbnail" onerror="this.src=\'https://i.postimg.cc/Dz6pv5fT/studyspark.png\'; this.onerror=null;" class="lecture-image-square" ').concat(w,' decoding="async" />\n        <div class="lecture-duration-badge">').concat(y,'</div>\n      </div>\n      \n      \x3c!-- Right: Content Area --\x3e\n      <div class="lecture-content-area">\n        \x3c!-- Top Right: Checkmark --\x3e\n        <div class="lecture-completion-button ').concat(k?"completed":"",'" data-lecture-id="').concat(x,'">\n          <i class="fas fa-check"></i>\n        </div>\n        \n        \x3c!-- Title Area Wrapper - matches square box height --\x3e\n        <div class="lecture-info-wrapper">\n          \x3c!-- Lecture Header --\x3e\n          <div class="lecture-header">\n            <span class="lecture-type-date">LECTURE • ').concat(b,'</span>\n          </div>\n          \n          \x3c!-- Lecture Title --\x3e\n          <h3 class="lecture-title-new">').concat(c,'</h3>\n        </div>\n        \n        \x3c!-- Action Buttons --\x3e\n        <div class="lecture-action-buttons">\n          <button class="lecture-view-btn">\n            <i class="fas fa-play"></i>\n            View Lecture\n          </button>\n          <button class="lecture-notes-btn">\n            <i class="fas fa-file-alt"></i>\n          </button>\n        </div>\n      </div>\n    </div>\n  '),k&&t.classList.add("completed"),t.onclick=async()=>{el(!0);try{if(h&&(h.includes("youtube.com")||h.includes("youtu.be")))return window.open(h,"_blank");let t=e._id,n=f;if(!t||!n)throw Error("Missing video ID or batch ID.");let a=o(t,n,e.topic||"Video Lecture",v);window.location.href=a}catch(e){alert("⚠️ Failed to load video.")}finally{el(!1)}};let I=t.querySelector(".lecture-completion-button");I&&(I.onclick=e=>{e.stopPropagation(),u(x,"lecture",I,t)})}g.appendChild(t)});let k=document.getElementById("contentLoadMoreWrapper");k&&k.remove();let L=s.paginate||{},j=L.totalCount||0;L.limit;let S=!1;if((S=j>0?(x-1)*20+l.length<j:20===l.length)||(I=x),S){let e=document.createElement("div");e.id="contentLoadMoreWrapper",e.style.cssText="text-align: center; margin: 20px 0; padding: 20px;";let t=document.createElement("button");t.className="load-more-btn",t.innerHTML='\n            <i class="fas fa-plus-circle" style="margin-right: 8px;"></i>\n            Load More Content\n          ',t.style.cssText="\n            background: linear-gradient(135deg, #0088cc, #229ED9);\n            color: white;\n            border: 3px solid rgba(255, 255, 255, 0.2);\n            padding: 12px 24px;\n            border-radius: 8px;\n            font-weight: 600;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            font-size: 0.95rem;\n            box-shadow: 0 4px 15px rgba(0, 136, 204, 0.3);\n          ",t.onmouseover=()=>{t.style.transform="translateY(-2px) scale(1.05)",t.style.boxShadow="0 8px 25px rgba(0, 136, 204, 0.4), 0 0 20px rgba(34, 158, 217, 0.3)",t.style.borderColor="rgba(255, 255, 255, 0.4)"},t.onmouseout=()=>{t.style.transform="translateY(0) scale(1)",t.style.boxShadow="0 4px 15px rgba(0, 136, 204, 0.3)",t.style.borderColor="rgba(255, 255, 255, 0.2)"},t.onclick=()=>{if(x<I||I===1/0)x++,ex(f,v,M,U,A,!0);else{let e=document.getElementById("contentLoadMoreWrapper");e&&e.remove()}},e.appendChild(t),document.getElementById("lectureSection").appendChild(e)}}catch(e){console.error("Failed to load content:",e)}finally{E=!1,"lectures"!==y&&el(!1)}}async function ek(e,t,n){try{el(!0);let a=await fetch("".concat(c,"/api/batch/").concat(e,"/subject/").concat(t,"/schedule/").concat(n,"/content")),o=await a.json();if(!o.data)return void alert("No content found.");let i=(o.data.homeworkIds||[]).flatMap(e=>e.attachmentIds||[]);if(!i.length)return void alert("No attachments found.");i.forEach(e=>{let t="".concat(e.baseUrl).concat(e.key);window.open(t,"_blank")})}catch(e){alert("Error loading attachments.")}finally{el(!1)}}function ew(e){U=({lectures:"LECTURES",notes:"ALL",dppnotes:"ALL",dppvideos:"ALL",dpplecture:"ALL"})[e]||"LECTURES",_=e,["lectures","notes","dppnotes","dppvideos","dpplecture"].forEach(e=>{let t=document.getElementById("tab-"+e);t&&t.classList.remove("active")});let t=document.getElementById("tab-"+e);t&&t.classList.add("active"),ex(f,v,M,U,A)}async function eI(e){let t=document.getElementById("liveClassesTab"),n=document.getElementById("announcementsTab"),a=document.getElementById("descriptionTab"),o=document.getElementById("todayScrollContainer"),i=document.getElementById("announcementsContainer"),s=document.getElementById("descriptionContainer"),l=document.getElementById("subjects");function c(e){e&&(e.style.display="none",e.style.visibility="hidden",e.style.opacity="0",e.style.position="absolute",e.style.left="-9999px",e.setAttribute("aria-hidden","true"))}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block";e&&(e.style.display=t,e.style.visibility="visible",e.style.opacity="1",e.style.position="relative",e.style.left="auto",e.removeAttribute("aria-hidden"))}if(t.classList.remove("active"),n.classList.remove("active"),a.classList.remove("active"),c(o),c(i),c(s),"live"===e){t.classList.add("active"),r(o,"block"),l&&r(l,"block");let e=document.getElementById("todayClassesHeader");if(!e){(e=document.createElement("div")).id="todayClassesHeader",e.className="today-classes-wrapper",e.innerHTML='\n            <h3 class="today-classes-title">\n              <i class="fas fa-calendar-day" style="margin-right: 0.5rem; color: #0084ff;"></i>\n              Today Classes\n            </h3>\n          ';let t=document.getElementById("todayScrollContainer");t&&t.parentNode&&t.parentNode.insertBefore(e,t)}e&&(e.style.display="block"),window.currentBatchId&&await Y(window.currentBatchId)}else if("announcements"===e){n.classList.add("active"),r(i,"flex"),l&&r(l,"block");let e=document.getElementById("todayClassesHeader");e&&(e.style.display="none"),window.currentBatchId&&ej(await eS(window.currentBatchId))}else if("description"===e){a.classList.add("active"),r(s,"flex"),l&&c(l);let e=document.getElementById("todayClassesHeader");e&&(e.style.display="none"),window.currentBatchId&&(N.has(window.currentBatchId)?eL(N.get(window.currentBatchId)):eL(await eE(window.currentBatchId)))}}async function eE(e){if(N.has(e))return N.get(e);if(C)return N.get(e)||null;try{C=!0;let t=Math.floor(Date.now()/1e3),n=await fetch("".concat(c,"/batch/").concat(encodeURIComponent(e),"/details"),{headers:{"X-Client-Info":t.toString(),"Content-Type":"application/json"}}),a=await n.json(),o=null;return a.data&&(o=a.data),N.set(e,o),o}catch(t){return console.error("❌ Error fetching batch description:",t),N.set(e,null),null}finally{C=!1}}function eL(e){let t=document.getElementById("descriptionContainer");if(!e){t.innerHTML='\n          <div class="description-placeholder">\n            <i class="fas fa-exclamation-triangle" style="font-size: 2rem; color: var(--squid-cyan); margin-bottom: 1rem;"></i>\n            <p>Unable to load batch description. Please try again.</p>\n          </div>\n        ';return}function n(e){if(!e)return!0;let t=document.createElement("div");return t.innerHTML=e,0===(t.textContent||t.innerText||"").trim().length}let a=e.shortDescription&&!n(e.shortDescription),o=e.description&&!n(e.description),i=e.previewImage&&e.previewImage.baseUrl&&e.previewImage.key;if(!a&&!o&&!i){t.innerHTML='\n          <div class="description-placeholder">\n            <i class="fas fa-info-circle" style="font-size: 2rem; color: var(--squid-cyan); margin-bottom: 1rem;"></i>\n            <p>Description not available for this batch.</p>\n          </div>\n        ';return}let s=document.createElement("div");if(s.className="description-content",i){let t="".concat(e.previewImage.baseUrl).concat(e.previewImage.key),n=document.createElement("img");n.src=t,n.alt=e.name||"Batch Image",n.className="description-image",n.onerror=function(){console.warn("Failed to load batch image:",t),this.style.display="none"},s.appendChild(n)}if(a){let t=document.createElement("div");t.className="description-html-content";let n=document.createElement("div");n.innerHTML=e.shortDescription;let a=n.querySelector("body");a?t.innerHTML=a.innerHTML:t.innerHTML=e.shortDescription,s.appendChild(t)}else if(o){let t=document.createElement("div");t.className="description-html-content";let n=document.createElement("div");n.innerHTML=e.description;let a=n.querySelector("body");a?t.innerHTML=a.innerHTML:t.innerHTML=e.description,s.appendChild(t)}t.innerHTML="",t.appendChild(s)}function ej(e){let t=document.getElementById("announcementsContainer");if(!e||0===e.length){t.innerHTML='\n          <div class="announcement-placeholder">\n            <i class="fas fa-bullhorn" style="font-size: 2rem; color: var(--squid-cyan); margin-bottom: 1rem;"></i>\n            <p>No announcements available for this batch.</p>\n          </div>\n        ';return}let n=document.createElement("div");n.className="announcements-list",n.style.cssText="\n        display: grid;\n        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n        gap: 16px;\n        padding: 0;\n        width: 100%;\n      ";let a=document.createElement("style");a.textContent="\n        @media (min-width: 1200px) {\n          .announcements-list {\n            grid-template-columns: repeat(3, 1fr) !important;\n          }\n        }\n        @media (min-width: 768px) and (max-width: 1199px) {\n          .announcements-list {\n            grid-template-columns: repeat(2, 1fr) !important;\n          }\n        }\n        @media (max-width: 767px) {\n          .announcements-list {\n            grid-template-columns: 1fr !important;\n          }\n        }\n        \n        /* Custom scrollbar styling for cards */\n        .announcement-card::-webkit-scrollbar {\n          width: 6px;\n        }\n        .announcement-card::-webkit-scrollbar-track {\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 3px;\n        }\n        .announcement-card::-webkit-scrollbar-thumb {\n          background: var(--squid-cyan);\n          border-radius: 3px;\n        }\n        .announcement-card::-webkit-scrollbar-thumb:hover {\n          background: #00d4ff;\n        }\n        .announcement-card {\n          scrollbar-width: thin;\n          scrollbar-color: var(--squid-cyan) rgba(255, 255, 255, 0.1);\n        }\n      ",document.querySelector("#announcements-grid-styles")||(a.id="announcements-grid-styles",document.head.appendChild(a)),e.forEach(e=>{let t,a=document.createElement("div");a.className="announcement-card",a.style.cssText="\n          background: rgba(255, 255, 255, 0.05);\n          border-radius: 12px;\n          padding: 16px;\n          border: 1px solid rgba(255, 255, 255, 0.1);\n          backdrop-filter: blur(10px);\n          transition: all 0.3s ease;\n          height: 400px;\n          overflow-y: auto;\n        ";let o=new Date(e.scheduleTime||e.createdAt),i=Math.floor((new Date-o)/36e5),s=Math.floor(i/24);t=s>0?"".concat(s," day").concat(s>1?"s":""," ago"):i>0?"".concat(i," hour").concat(i>1?"s":""," ago"):"Just now";let l=e.announcement||"No content available",c='\n          <div style="display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px;">\n            <div style="\n              width: 40px;\n              height: 40px;\n              border-radius: 50%;\n              background: rgba(255, 255, 255, 0.1);\n              display: flex;\n              align-items: center;\n              justify-content: center;\n              flex-shrink: 0;\n              overflow: hidden;\n              border: 2px solid rgba(255, 255, 255, 0.2);\n            ">\n              <img src="https://i.postimg.cc/1XzFr3sZ/studyspark-circle.png" alt="StudySpark" loading="lazy" decoding="async" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;" />\n            </div>\n            <div style="flex: 1;">\n              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">\n                <span style="font-weight: 600; color: #fff; font-size: 14px;">'.concat("StudySpark",'</span>\n              </div>\n              <div style="color: rgba(255, 255, 255, 0.6); font-size: 12px;">').concat(t,'</div>\n            </div>\n          </div>\n          \n          <div style="margin-bottom: 12px;">\n            <p style="color: #fff; font-size: 14px; line-height: 1.4; margin: 0; white-space: pre-wrap;">').concat(eT(l),"</p>\n          </div>\n        ");if(e.attachment&&e.attachment.baseUrl&&e.attachment.key){let t=e.attachment,n="".concat(t.baseUrl).concat(t.key),a=t.name||t.key.split("/").pop()||"Attachment";/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(t.key)?c+='\n              <div style="margin-top: 12px;">\n                <img src="'.concat(n,'" alt="').concat(a,'" \n                     loading="lazy" decoding="async"\n                     style="\n                       width: 100%;\n                       max-width: 400px;\n                       height: auto;\n                       border-radius: 8px;\n                       border: 1px solid rgba(255, 255, 255, 0.1);\n                       transition: transform 0.2s ease;\n                     "\n                     onmouseover="this.style.transform=\'scale(1.02)\'"\n                     onmouseout="this.style.transform=\'scale(1)\'" />\n              </div>\n            '):c+='\n              <div style="\n                margin-top: 12px;\n                padding: 12px;\n                background: rgba(255, 255, 255, 0.05);\n                border-radius: 8px;\n                border: 1px solid rgba(255, 255, 255, 0.1);\n                cursor: pointer;\n                transition: background 0.2s ease;\n              " onclick="window.open(\''.concat(n,'\', \'_blank\')"\n                 onmouseover="this.style.background=\'rgba(255, 255, 255, 0.1)\'"\n                 onmouseout="this.style.background=\'rgba(255, 255, 255, 0.05)\'">\n                <div style="display: flex; align-items: center; gap: 8px;">\n                  <i class="fas fa-file" style="color: var(--squid-cyan); font-size: 16px;"></i>\n                  <span style="color: rgba(255, 255, 255, 0.9); font-size: 14px;">').concat(a,"</span>\n                </div>\n              </div>\n            ")}a.innerHTML=c,a.addEventListener("mouseenter",()=>{a.style.transform="translateY(-2px)",a.style.boxShadow="0 8px 25px rgba(0, 0, 0, 0.3)"}),a.addEventListener("mouseleave",()=>{a.style.transform="translateY(0)",a.style.boxShadow="none"}),n.appendChild(a)}),t.innerHTML="",t.appendChild(n)}async function eS(e){if(S.has(e))return S.get(e);if(T)return S.get(e)||[];try{T=!0;let t=await fetch("".concat(c,"/batch/").concat(encodeURIComponent(e),"/announcement")),n=await t.json(),a=[];return n.data&&Array.isArray(n.data)&&(a=n.data),S.set(e,a),a}catch(t){return S.set(e,[]),[]}finally{T=!1}}function eT(e){return e.replace(/(https?:\/\/[^\s]+|www\.[^\s]+)/gi,e=>{let t=e.startsWith("http")?e:"https://".concat(e);return'<a href="'.concat(t,'" target="_blank" rel="noopener noreferrer" style="color: #87CEEB; text-decoration: underline; word-break: break-all;">').concat(e,"</a>")})}function n(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function a(e){return e.subjectSlug?e.subjectSlug:e.subject?e.subject.toLowerCase().replace(/[^a-z0-9]+/g,"-"):e.subjectName?e.subjectName.toLowerCase().replace(/[^a-z0-9]+/g,"-"):"general"}function eN(e){let t=document.getElementById("todayHeaderTitle");t&&e&&(t.textContent=e)}m.addEventListener("input",eb(()=>{let e=m.value.trim();e!==F&&(F=e,em({reset:!0}))},500)),window.loadSubjects=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"description";history.pushState({},"","?batch=".concat(e)),ec(l),d.style.display="block",l.innerHTML="",m.style.display="none",el(!0),b&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a="StudySpark";e&&(a=n&&t?"".concat(n," - ").concat(t," - ").concat(e," - StudySpark"):t?"".concat(t," - ").concat(e," - StudySpark"):"".concat(e," - StudySpark")),document.title=a}(b);let i=document.getElementById("chapterLoadMoreWrapper");i&&(i.style.display="none");try{var s;let i=Math.floor(Date.now()/1e3),r=await fetch("".concat(c,"/batch/").concat(encodeURIComponent(e),"/details"),{headers:{"X-Client-Info":i.toString(),"Content-Type":"application/json"}}),d=await r.json(),p=d.data&&d.data.subjects||[];d.data&&N.set(e,d.data);let u=(null==(s=d.data)?void 0:s.name)||"Batch Details";if(eN(u),0===p.length){l.innerHTML='<div style="color: var(--text-muted); padding: 20px; text-align: center; background: rgba(255, 255, 255, 0.05); border-radius: 12px; margin: 10px; border: 1px solid rgba(255, 255, 255, 0.1); font-size: 0.9rem;"><i class="fas fa-folder-times" style="margin-right: 8px; opacity: 0.7;"></i>Failed to load batch subjects.</div>',el(!1);return}p.forEach(t=>{!function(e,t,n){var a;let o=t.subject,i=t.imageId?"".concat(t.imageId.baseUrl).concat(t.imageId.key):"https://i.postimg.cc/1XzFr3sZ/studyspark-circle.png",s=t.lectureCount||0,l=t.tagCount||0,c=null==(a=t.teacherIds)?void 0:a[0],r=(null==c?void 0:c.imageId)?"".concat(c.imageId.baseUrl).concat(c.imageId.key):"https://i.postimg.cc/1XzFr3sZ/studyspark-circle.png",d=c?"".concat(c.firstName," ").concat(c.lastName):"Coming Soon..",p=document.createElement("div");p.className="subject-card",p.onclick=n,p.innerHTML='\n    <div class="card-header">\n      <img class="subject-icon" src="'.concat(i,'" alt="').concat(o,'" loading="lazy" decoding="async" />\n      <div class="subject-title">').concat(o,'</div>\n    </div>\n    <div class="card-details">\n      <div><i class="fas fa-video"></i> ').concat(s,' Lectures</div>\n      <div><i class="fas fa-file-alt"></i> ').concat(l,' Chapters</div>\n    </div>\n    <div class="teacher-info">\n      <img class="teacher-img" src="').concat(r,'" alt="').concat(d,'" loading="lazy" decoding="async" />\n      <div class="teacher-name">').concat(d,"</div>\n    </div>\n  "),e.appendChild(p)}(l,t,()=>{var n;y=1,g=!1;let a=t.slug||t.subjectSlug||t.subject.toLowerCase().replace(/[^a-z0-9]+/g,"-");H=t._id||"",v=a,t.subject;let o=null==(n=t.teacherIds)?void 0:n[0];P=(null==o?void 0:o.imageId)?"".concat(o.imageId.baseUrl).concat(o.imageId.key):"https://i.postimg.cc/1XzFr3sZ/studyspark-circle.png",localStorage.setItem("currentTeacherImage",P),ev(e,H)})});let m=await Y(e),h=document.getElementById("todayWrapper"),b=document.getElementById("todayScrollContainer");"none"!==document.getElementById("subjects").style.display&&(h.style.display="block"),eI(t),0===m.length?b.innerHTML='<div class="no-live-classes-message"><i class="fas fa-calendar-times" style="margin-right: 8px; opacity: 0.7;"></i>No live classes today.</div>':b.innerHTML="",m.forEach(e=>{var t,i,s,l,r;let d=e.topic||e.homeworkIds&&e.homeworkIds[0]&&e.homeworkIds[0].topic||"Untitled",p=(null==(t=e.subjectId)?void 0:t.name)||"Unknown Subject",u=new Date(e.startTime).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),m=(null==(s=e.tags)||null==(i=s[0])?void 0:i.name)||"General",h=e.tag||"Upcoming",y=(null==(l=e.videoDetails)?void 0:l.image)||"https://i.postimg.cc/Dz6pv5fT/studyspark.png";null==(r=e.videoDetails)||r.duration;let g=document.createElement("div");g.className="today-card";let v=n()?'crossorigin="anonymous"':"",w="Upcoming"===h?"opacity: 0.65; filter: grayscale(0.2); transition: all 0.3s ease;":"";g.innerHTML='\n    <div class="today-card-inner" style="'.concat("Upcoming"===h?"background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05);":"",'">\n      <div class="today-thumbnail" style="').concat(w,'">\n        <img src="').concat(y,'" alt="').concat(d,'" class="today-image" ').concat(v,' loading="lazy" decoding="async" />\n        <div class="video-watermark-top">\n          <img src="https://i.postimg.cc/1XzFr3sZ/studyspark-circle.png" alt="StudySpark" class="watermark-logo">\n          @StudySpark\n        </div>\n        <div class="today-play-button">\n          <i class="fas fa-play"></i>\n        </div>\n      </div>\n      <div class="status-tag" style="position: absolute; top: 10px; right: 10px; background: ').concat("Live"===h?"#00FF88":"Ended"===h?"#FF4444":"#2196F3",'; color: black; font-weight: bold; font-size: 0.75rem; padding: 2px 6px; border-radius: 6px; z-index: 3;">').concat(h,'</div>\n      <div class="today-info" style="').concat(w,'">\n        <div class="today-meta">\n          <span class="today-subject" style="color: var(--text-muted); font-size: 0.85rem;">').concat(p,'</span>\n          <span class="today-time" style="font-size: 0.85rem; color: #c4c4c4;">\uD83D\uDD52 ').concat(u,' IST</span>\n        </div>\n        <h3 class="today-card-title">').concat(d,'</h3>\n        <div class="today-details">\n          <div style="margin-top: 5px; font-size: 0.75rem; background: rgba(0, 0, 0, 0.8); color: #fff; padding: 3px 8px; border-radius: 4px; display: inline-block; font-weight: 500;">').concat(m,"</div>\n        </div>\n      </div>\n    </div>\n  "),g.onclick=async()=>{var t,n,i,s;if("Upcoming"===h)return void eo("Live class will start at ".concat(u," IST"),"warning");if("CANCELED"===e.status)return void eo("This class has been cancelled.","error");let l=(null==(t=e.batch)?void 0:t._id)||(null==(n=e.batchId)?void 0:n._id)||e.batchId,r=e._id;if(!l||!r)return void alert("Invalid class identifiers.");el(!0);try{if(!0===e.isVideoLecture){let t=e._id,n=o(r,l,e.topic||"Live Class",a(e),!0,e.conversationId,t);window.location.href=n}else if(e.homeworkIds&&e.homeworkIds.length>0)try{let t=(null==(i=e.subjectId)?void 0:i.slug)||"unknown",n=e._id,a=null==(s=e.subjectId)?void 0:s._id;if(!a&&f&&t){let e=Math.floor(Date.now()/1e3),n=await fetch("".concat(c,"/batch/").concat(f,"/details"),{headers:{"X-Client-Info":e.toString(),"Content-Type":"application/json"}}),o=await n.json(),i=(o.data&&o.data.subjects||[]).find(e=>(e.slug||e.subjectSlug||e.subject.toLowerCase().replace(/[^a-z0-9]+/g,"-"))===t);i&&i._id&&(a=i._id)}if(a){let o=await fetch("".concat(c,"/batch/").concat(l,"/subject/").concat(a,"/attachment-links?scheduleId=").concat(n,"&subjectSlug=").concat(t)),i=await o.json();if(i.success&&i.data&&i.data.length>0)i.data.forEach(e=>{window.open(e.url,"_blank")});else{let t=!1;e.homeworkIds.forEach(e=>{e.attachmentIds&&e.attachmentIds.length>0&&e.attachmentIds.forEach(e=>{let n="".concat(e.baseUrl).concat(e.key);window.open(n,"_blank"),t=!0})}),t||alert("No attachments found for this class.")}}else throw Error("Subject ID not found")}catch(n){console.error("Error fetching attachment links:",n);let t=!1;e.homeworkIds.forEach(e=>{e.attachmentIds&&e.attachmentIds.length>0&&e.attachmentIds.forEach(e=>{let n="".concat(e.baseUrl).concat(e.key);window.open(n,"_blank"),t=!0})}),t||alert("Error loading attachments. Please try again.")}else{let t=e._id,n=o(r,l,e.topic||"Live Class",a(e),!0,e.conversationId,t);window.location.href=n}}catch(e){alert("⚠️ Failed to load live class.")}finally{el(!1)}},b.appendChild(g)})}catch(e){console.error("Failed to load subjects or todayclass:",e)}finally{el(!1)}},window.switchBatchTab=async function(e){let t=document.getElementById("allBatchesTab"),n=document.getElementById("favoriteBatchesTab"),a=document.getElementById("main");function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"grid";e&&(e.style.display=t,e.style.visibility="visible",e.style.opacity="1",e.style.position="relative",e.style.left="auto",e.removeAttribute("aria-hidden"))}if(eg=e,t&&t.classList.remove("active"),n&&n.classList.remove("active"),"all"===e){t&&t.classList.add("active"),o(a,"grid"),F="";let e=document.getElementById("searchInput");e&&(e.value=""),em({reset:!0})}else"favorites"===e&&(n&&n.classList.add("active"),o(a,"grid"),window.showFavoriteBatches())},window.handleBatchSelection=async function(e){let t=e.target.value,[i,s,l]=["todayScheduleSection","viewAllClassesSection","todayClassesContent"].map(e=>document.getElementById(e));if(!t){i&&(i.style.display="none"),s&&(s.style.display="none");return}i&&(i.style.display="block"),s&&(s.style.display="block"),window.currentBatchId=t,l&&(l.innerHTML='<div style="display:flex;align-items:center;justify-content:center;padding:40px;color:rgba(255,255,255,0.6)"><div><div class="loader"></div><div>Loading today\'s classes...</div></div></div>');try{let e=await Y(t);0===e.length?todayClassesContent.innerHTML='<div style="color: rgba(255, 255, 255, 0.6); padding: 20px; text-align: center; background: rgba(255, 255, 255, 0.05); border-radius: 12px; margin:10px; border: 1px solid rgba(255, 255, 255, 0.1); font-size: 0.9rem;"><i class="fas fa-calendar-times" style="margin-right: 8px; opacity: 0.7;"></i>No live classes today.</div>':(todayClassesContent.innerHTML="",e.forEach(e=>{var t,i,s,l,c;let r=e.topic||e.homeworkIds&&e.homeworkIds[0]&&e.homeworkIds[0].topic||"Untitled",d=(null==(t=e.subjectId)?void 0:t.name)||"Unknown Subject",p=new Date(e.startTime).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"}),u=(null==(s=e.tags)||null==(i=s[0])?void 0:i.name)||"General",m=e.tag||"Upcoming",h=(null==(l=e.videoDetails)?void 0:l.image)||"https://i.postimg.cc/Dz6pv5fT/studyspark.png";null==(c=e.videoDetails)||c.duration;let y=document.createElement("div");y.className="today-card";let g=n()?'crossorigin="anonymous"':"",f="Upcoming"===m?"opacity: 0.65; filter: grayscale(0.2); transition: all 0.3s ease;":"";y.innerHTML='\n              <div class="today-card-inner" style="'.concat("Upcoming"===m?"background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05);":"",'">\n                <div class="today-thumbnail" style="').concat(f,'">\n                  <img src="').concat(h,'" alt="').concat(r,'" class="today-image" ').concat(g,' loading="lazy" decoding="async" />\n                  <div class="video-watermark-top">\n                    <img src="https://i.postimg.cc/1XzFr3sZ/studyspark-circle.png" alt="StudySpark" class="watermark-logo">\n                    @StudySpark\n                  </div>\n                  <div class="today-play-button">\n                    <i class="fas fa-play"></i>\n                  </div>\n                </div>\n                <div class="status-tag" style="position: absolute; top: 10px; right: 10px; background: ').concat("Live"===m?"#00FF88":"Ended"===m?"#FF4444":"#2196F3",'; color: black; font-weight: bold; font-size: 0.75rem; padding: 2px 6px; border-radius: 6px; z-index: 3;">').concat(m,'</div>\n                <div class="today-info" style="').concat(f,'">\n                  <div class="today-meta">\n                    <span class="today-subject" style="color: var(--text-muted); font-size: 0.85rem;">').concat(d,'</span>\n                    <span class="today-time" style="font-size: 0.85rem; color: #c4c4c4;">\uD83D\uDD52 ').concat(p,' IST</span>\n                  </div>\n                  <h3 class="today-card-title">').concat(r,'</h3>\n                  <div class="today-details">\n                    <div style="margin-top: 5px; font-size: 0.75rem; background: rgba(0, 0, 0, 0.8); color: #fff; padding: 3px 8px; border-radius: 4px; display: inline-block; font-weight: 500;">').concat(u,"</div>\n                  </div>\n                </div>\n              </div>\n            "),y.onclick=async()=>{var t,n;if("Upcoming"===m)return void eo("Live class will start at ".concat(p," IST"),"warning");if("CANCELED"===e.status)return void eo("This class has been cancelled.","error");let i=(null==(t=e.batch)?void 0:t._id)||(null==(n=e.batchId)?void 0:n._id)||e.batchId,s=e._id;if(!i||!s)return void eo("Invalid class identifiers.","error");el(!0);try{if(!0===e.isVideoLecture){let t=o(s,i,e.topic||"Live Class",a(e),!0);window.location.href=t}else if(e.homeworkIds&&e.homeworkIds.length>0){let t=e.homeworkIds.flatMap(e=>e.attachmentIds||[]);t.length>0&&t.forEach(e=>{if(e.baseUrl&&e.key){let t="".concat(e.baseUrl).concat(e.key);window.open(t,"_blank")}})}else{let t=o(s,i,e.topic||"Live Class",a(e),!0);window.location.href=t}}catch(e){console.error("Error loading class:",e),eo("⚠️ Failed to load live class.","error")}finally{el(!1)}},todayClassesContent.appendChild(y)}))}catch(e){console.error("Error loading today's schedule:",e),l&&(l.innerHTML='<div style="color:rgba(255,255,255,0.6);padding:20px;text-align:center"><i class="fas fa-exclamation-triangle" style="margin-right:8px"></i>Error loading today\'s classes</div>')}},window.showAllBatches=function(){history.pushState({},"",window.location.pathname),er();let e=document.getElementById("main"),t=document.getElementById("searchInput"),n=document.getElementById("backBtn");e&&(e.style.display="grid"),t&&(t.style.display="block"),n&&(n.style.display="none"),F="",t&&(t.value=""),eg="all",em({reset:!0})},window.generatePlayerURL=o,window.loadTodaysSchedule=Y,window.getFavoriteBatches=R,window.isFavoriteBatch=Z,window.toggleFavoriteBatch=Q,window.fetchFavoriteBatches=K,window.isBatchBookmarked=function(e){return Z(e)},window.toggleBookmark=function(e,t){return Q(e,t)},window.checkTokenExpiry=$,window.showTokenNotification=ee,window.showNotification=eo,window.showBatchesView=ei,window.showLoader=el,window.show=ec,window.clearAll=er,window.handleBackNavigation=ed,window.pushView=ep,window.appendCard=eu,window.loadBatches=em,window.renderBatches=eh,window.renderNoResults=ey,window.loadChapters=ev,window.switchLectureTab=ew,window.loadLecturesContent=ex,window.fetchAndOpenAttachments=ek,window.switchTodayTab=eI,window.renderAnnouncements=ej,window.fetchAnnouncements=eS,window.convertUrlsToLinks=eT,window.isSafari=n,window.getSubjectSlug=a,window.updateHeaderTitle=eN;let eC=setTimeout(()=>{if(!e&&!t){(()=>{if(e||t)return;t=!0,$();let n=new URLSearchParams(window.location.search),a=n.get("batch"),o=n.get("subject"),i=n.get("topic"),s=n.get("type")||"LECTURES",l=n.get("tag");a&&o&&i?ex(a,o,i,s,l):a&&o?ev(a,o):a?loadSubjects(a):ei();let c=document.getElementById("searchInput");c&&!c.hasAttribute("data-listener-attached")&&(c.setAttribute("data-listener-attached","true"),c.addEventListener("input",eb(()=>{let e=c.value.trim();e!==F&&(F=e,em({reset:!0}))},500)));let r=document.getElementById("searchInput"),d=document.querySelector(".floating-telegram-btn"),p=!n.get("batch")&&!n.get("subject")&&!n.get("topic");r&&(r.style.display=p?"block":"none"),d&&(d.style.display="block"),k(),e=!0,t=!1})(),(()=>{let n=document.getElementById("themeToggle"),a=document.getElementById("themeIcon"),o=document.body,i=localStorage.getItem("theme")||"dark",s=document.getElementById("themeDropdown");s||((s=document.createElement("div")).id="themeDropdown",s.className="theme-dropdown",s.innerHTML='\n          <div class="theme-option" data-theme="dark">\n            <span class="theme-icon">\uD83C\uDF19</span>\n            <span class="theme-name">Dark Mode</span>\n          </div>\n          <div class="theme-option" data-theme="light">\n            <span class="theme-icon">☀️</span>\n            <span class="theme-name">Light Mode</span>\n          </div>\n          <div class="theme-option" data-theme="study">\n            <span class="theme-icon">\uD83D\uDCD6</span>\n            <span class="theme-name">Study Mode</span>\n          </div>\n        ',n.parentNode.appendChild(s));let l=e=>{switch(o.classList.remove("light-theme","study-theme"),n.classList.remove("dark","light","study"),document.querySelectorAll(".theme-option").forEach(e=>{e.classList.remove("active")}),document.querySelector('[data-theme="'.concat(e,'"]')).classList.add("active"),e){case"light":o.classList.add("light-theme"),n.classList.add("light"),a.textContent="☀️";break;case"study":o.classList.add("study-theme"),n.classList.add("study"),a.textContent="\uD83D\uDCD6";break;default:n.classList.add("dark"),a.textContent="\uD83C\uDF19"}};l(i),n&&!n.hasAttribute("data-listener-attached")&&(n.setAttribute("data-listener-attached","true"),n.addEventListener("click",e=>{e.stopPropagation(),s.classList.toggle("show")}),s.addEventListener("click",e=>{let t=e.target.closest(".theme-option");if(t){let e=t.dataset.theme;l(e),localStorage.setItem("theme",e),s.classList.remove("show")}}),document.addEventListener("click",e=>{n.contains(e.target)||s.contains(e.target)||s.classList.remove("show")})),k(),e=!0,t=!1,window.setIsInitialLoading&&setTimeout(()=>{window.setIsInitialLoading(!1)},500)})(),(()=>{let e=document.getElementById("loginBtn"),t=document.getElementById("userDropdown"),n=document.getElementById("userBtn"),a=document.getElementById("userMenu"),o=document.getElementById("logoutBtn"),i=async e=>{try{let t=await fetch("".concat(c,"/user-info"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)return console.warn("⚠️ Token verification failed"),localStorage.removeItem("studyspark_token"),localStorage.removeItem("studyspark_username"),localStorage.removeItem("studyspark_name"),null;{let e=await t.json();if(e.success&&e.data)return localStorage.setItem("studyspark_name",e.data.name),localStorage.setItem("studyspark_username",e.data.number),e.data}}catch(e){return console.error("❌ Error verifying token:",e),null}};(async()=>{let n=localStorage.getItem("studyspark_token"),a=localStorage.getItem("studyspark_username");if(!n||!a)return e&&(e.style.display="block"),t&&(t.style.display="none");{let a=await i(n);if(!a)return e&&(e.style.display="block"),t&&(t.style.display="none");{e&&(e.style.display="none"),t&&(t.style.display="block");let n=document.getElementById("userDisplayName");return n&&(n.textContent=a.name||a.number)}}})(),e&&e.addEventListener("click",()=>{window.location.href="/login"}),n&&n.addEventListener("click",e=>{e.stopPropagation(),a&&a.classList.toggle("show")}),o&&o.addEventListener("click",()=>{localStorage.removeItem("studyspark_token"),localStorage.removeItem("studyspark_username"),localStorage.removeItem("studyspark_name"),eo("Logged out successfully!","success"),setTimeout(()=>{window.location.reload()},1e3)}),document.addEventListener("click",e=>{!a||(null==t?void 0:t.contains(e.target))||a.classList.remove("show")})})();let n=document.getElementById("lectureAttachmentsModal"),a=document.getElementById("lectureAttachmentsCloseBtn");a&&a.addEventListener("click",()=>{J()}),n&&n.addEventListener("click",e=>{e.target===n&&J()})}},100);return()=>{clearTimeout(eC),e=!1,t=!1}},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s(),{children:(0,a.jsx)("title",{children:"StudySpark"})}),e&&(0,a.jsxs)("div",{className:"loading-overlay",style:{display:"flex",zIndex:9999},children:[(0,a.jsx)("div",{className:"spinner"}),(0,a.jsx)("p",{className:"loading-text",children:"Initializing..."})]}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{id:"loadingOverlay",className:"loading-overlay",style:{display:"none"},children:[(0,a.jsx)("div",{className:"spinner"}),(0,a.jsx)("p",{className:"loading-text",children:"Loading..."})]}),(0,a.jsx)("div",{id:"notificationPopup",className:"notification-popup",style:{display:"none"},children:(0,a.jsxs)("div",{className:"notification-content",children:[(0,a.jsx)("i",{className:"fas fa-exclamation-triangle notification-icon"}),(0,a.jsx)("span",{className:"notification-message"})]})}),(0,a.jsx)("div",{id:"tokenNotification",className:"token-notification",style:{display:"none"},children:(0,a.jsxs)("div",{className:"token-notification-content",children:[(0,a.jsx)("i",{className:"fas fa-clock token-notification-icon"}),(0,a.jsxs)("div",{className:"token-notification-text",children:[(0,a.jsx)("div",{className:"token-notification-title",children:"Access Token"}),(0,a.jsxs)("div",{className:"token-notification-message",children:["Expires in ",(0,a.jsx)("span",{id:"tokenTimeLeft"})]})]})]})}),(0,a.jsx)("div",{id:"favoriteNotification",className:"token-notification",style:{display:"none"},children:(0,a.jsxs)("div",{className:"token-notification-content",children:[(0,a.jsx)("i",{id:"favoriteNotificationIcon",className:"fas fa-star token-notification-icon"}),(0,a.jsxs)("div",{className:"token-notification-text",children:[(0,a.jsx)("div",{id:"favoriteNotificationTitle",className:"token-notification-title",children:"Favorites"}),(0,a.jsx)("div",{id:"favoriteNotificationMessage",className:"token-notification-message"})]})]})}),(0,a.jsx)("header",{className:"main-header",children:(0,a.jsxs)("div",{className:"header-container",children:[(0,a.jsxs)("div",{className:"header-left",children:[(0,a.jsxs)("button",{id:"hamburgerMenu",className:"hamburger-menu",children:[(0,a.jsx)("span",{className:"hamburger-line"}),(0,a.jsx)("span",{className:"hamburger-line"}),(0,a.jsx)("span",{className:"hamburger-line"})]}),(0,a.jsx)("div",{className:"logo-container",children:(0,a.jsx)("img",{src:"https://i.postimg.cc/1XzFr3sZ/studyspark-circle.png",alt:"StudySpark Logo",className:"header-logo"})}),(0,a.jsx)("h1",{id:"typewriter-text",className:"header-title",style:{visibility:"hidden"},children:"StudySpark"})]}),(0,a.jsxs)("div",{className:"header-right",children:[(0,a.jsx)("button",{id:"themeToggle",className:"theme-toggle-btn",children:(0,a.jsx)("span",{id:"themeIcon",children:"\uD83C\uDF19"})}),(0,a.jsxs)("button",{id:"loginBtn",className:"login-btn",style:{display:"block"},children:[(0,a.jsx)("i",{className:"fas fa-sign-in-alt"})," Login"]}),(0,a.jsxs)("div",{id:"userDropdown",className:"user-dropdown",style:{display:"none"},children:[(0,a.jsx)("button",{id:"userBtn",className:"user-btn",children:(0,a.jsx)("i",{className:"fas fa-user-circle"})}),(0,a.jsxs)("div",{id:"userMenu",className:"user-menu",children:[(0,a.jsxs)("div",{className:"user-menu-header",children:[(0,a.jsx)("i",{className:"fas fa-user"}),(0,a.jsx)("span",{id:"userDisplayName",children:"User"})]}),(0,a.jsx)("div",{className:"user-menu-divider"}),(0,a.jsxs)("div",{className:"user-menu-item",id:"logoutBtn",children:[(0,a.jsx)("i",{className:"fas fa-sign-out-alt"})," Logout"]})]})]})]})]})}),(0,a.jsxs)("div",{id:"sidebar",className:"sidebar",children:[(0,a.jsxs)("div",{className:"sidebar-header",children:[(0,a.jsx)("div",{className:"sidebar-logo-container",children:(0,a.jsx)("img",{src:"https://i.postimg.cc/1XzFr3sZ/studyspark-circle.png",alt:"StudySpark Logo",className:"sidebar-logo"})}),(0,a.jsx)("h2",{id:"sidebar-typewriter-text",className:"sidebar-title",style:{visibility:"hidden"},children:"StudySpark"})]}),(0,a.jsx)("nav",{className:"sidebar-nav",children:(0,a.jsxs)("ul",{className:"sidebar-menu",children:[(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"#",className:"sidebar-link",children:[(0,a.jsx)("i",{className:"fas fa-star"})," My Batches"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"#",className:"sidebar-link",children:[(0,a.jsx)("i",{className:"fas fa-layer-group"})," All Batches"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"https://nt.studyspark.site",target:"_blank",className:"sidebar-link",children:[(0,a.jsx)("i",{className:"fas fa-crown"})," Next Toppers"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"https://books.studyspark.site",target:"_blank",className:"sidebar-link",children:[(0,a.jsx)("i",{className:"fas fa-book"})," Books"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"https://ai.studyspark.site",target:"_blank",className:"sidebar-link",children:[(0,a.jsx)("i",{className:"fas fa-robot"})," StudySpark AI"]})}),(0,a.jsx)("li",{children:(0,a.jsxs)("a",{href:"https://t.me/+6ZYsttJPRmFkNDU9",target:"_blank",className:"sidebar-link telegram-link",children:[(0,a.jsx)("i",{className:"fab fa-telegram"})," Join Telegram"]})})]})})]}),(0,a.jsx)("div",{id:"sidebarOverlay",className:"sidebar-overlay"}),(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("input",{type:"text",id:"searchInput",placeholder:"\uD83D\uDD0D Enter Batch name",style:{display:"none"}}),(0,a.jsx)("div",{className:"grid",id:"main"}),(0,a.jsx)("div",{className:"back-btn",id:"backBtn",style:{display:"none"},children:"← Back"}),(0,a.jsxs)("div",{className:"today-classes-wrapper",id:"todayWrapper",style:{display:"none"},children:[(0,a.jsxs)("div",{className:"today-header-container",children:[(0,a.jsx)("div",{className:"today-header",id:"todayHeader",children:(0,a.jsx)("h2",{className:"today-header-title",id:"todayHeaderTitle",children:"UDAY 2026 (Class 11th)"})}),(0,a.jsxs)("div",{className:"today-tabs",children:[(0,a.jsx)("div",{className:"today-tab active",id:"descriptionTab",onClick:()=>switchTodayTab("description"),children:(0,a.jsx)("span",{children:"Description"})}),(0,a.jsx)("div",{className:"today-tab",id:"liveClassesTab",onClick:()=>switchTodayTab("live"),children:(0,a.jsx)("span",{children:"All Classes"})}),(0,a.jsx)("div",{className:"today-tab",id:"announcementsTab",onClick:()=>switchTodayTab("announcements"),children:(0,a.jsx)("span",{children:"Announcements"})})]})]}),(0,a.jsxs)("div",{className:"today-content",children:[(0,a.jsx)("div",{className:"today-scroll-container today-classes-container",id:"todayScrollContainer",style:{display:"none"}}),(0,a.jsx)("div",{className:"announcements-container",id:"announcementsContainer",style:{display:"none"},children:(0,a.jsxs)("div",{className:"announcement-placeholder",children:[(0,a.jsx)("i",{className:"fas fa-bullhorn",style:{fontSize:"2rem",color:"var(--squid-cyan)",marginBottom:"1rem"}}),(0,a.jsx)("p",{children:"Announcements will be available soon!"})]})}),(0,a.jsx)("div",{className:"description-container",id:"descriptionContainer",style:{display:"flex"},children:(0,a.jsxs)("div",{className:"description-placeholder",children:[(0,a.jsx)("i",{className:"fas fa-info-circle",style:{fontSize:"2rem",color:"var(--squid-cyan)",marginBottom:"1rem"}}),(0,a.jsx)("p",{children:"Loading batch description..."})]})})]})]}),(0,a.jsx)("div",{id:"subjects",className:"subjects-container",style:{display:"none"}}),(0,a.jsx)("div",{id:"chaptersDiv",className:"card-grid",style:{display:"none"}}),(0,a.jsxs)("div",{id:"lectureSection",style:{display:"none"},children:[(0,a.jsxs)("div",{className:"lecture-tabs",children:[(0,a.jsx)("button",{id:"tab-lectures",className:"active",onClick:()=>switchLectureTab("lectures"),children:"Lectures"}),(0,a.jsx)("button",{id:"tab-notes",onClick:()=>switchLectureTab("notes"),children:"Notes"}),(0,a.jsx)("button",{id:"tab-dppnotes",onClick:()=>switchLectureTab("dppnotes"),children:"DPPs"}),(0,a.jsx)("button",{id:"tab-dppvideos",onClick:()=>switchLectureTab("dppvideos"),style:{display:"none"},children:"DPP Videos"}),(0,a.jsx)("button",{id:"tab-dpplecture",onClick:()=>switchLectureTab("dpplecture"),style:{display:"none"},children:"DPP Lectures"})]}),(0,a.jsx)("div",{className:"grid",id:"lectureContent"})]}),(0,a.jsx)("div",{id:"telegramPopup",className:"popup",children:(0,a.jsxs)("div",{className:"popup-content popup-square",children:[(0,a.jsx)("span",{className:"popup-close",children:"\xd7"}),(0,a.jsx)("img",{src:"https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg",alt:"Telegram Icon",className:"telegram-icon"}),(0,a.jsx)("h2",{children:"Join Our Telegram Channel!"}),(0,a.jsx)("p",{children:"To Get New Updates Fast !"}),(0,a.jsx)("a",{href:"https://t.me/+6ZYsttJPRmFkNDU9",target:"_blank",className:"telegram-btn",children:"Join Now"})]})}),(0,a.jsx)("div",{id:"aiPopup",className:"ai-popup",children:(0,a.jsxs)("div",{className:"ai-popup-content",children:[(0,a.jsx)("button",{className:"ai-popup-close",onClick:()=>g(),children:"\xd7"}),(0,a.jsx)("div",{className:"ai-iframe-container",children:(0,a.jsx)("iframe",{id:"aiIframe",src:"https://ai.studyspark.site",title:"StudySpark AI",className:"ai-iframe",frameBorder:"0",allowFullScreen:!0})})]})}),(0,a.jsx)("div",{id:"pdfModal",className:"pdf-modal",style:{display:"none"},children:(0,a.jsxs)("div",{className:"pdf-modal-content",children:[(0,a.jsxs)("div",{className:"pdf-modal-header",children:[(0,a.jsx)("h3",{id:"pdfModalTitle",children:"PDF Preview"}),(0,a.jsx)("div",{className:"pdf-controls",children:(0,a.jsx)("button",{className:"pdf-btn pdf-close-btn",onClick:()=>closePdfModal(),title:"Close",children:(0,a.jsx)("i",{className:"fas fa-times"})})})]}),(0,a.jsxs)("div",{className:"pdf-modal-body",children:[(0,a.jsxs)("div",{id:"pdfLoading",className:"pdf-loading",children:[(0,a.jsx)("div",{className:"spinner"}),(0,a.jsx)("p",{children:"Loading PDF..."})]}),(0,a.jsx)("div",{id:"pdfPagesContainer",className:"pdf-pages-container"})]})]})}),(0,a.jsx)("div",{id:"lectureAttachmentsModal",className:"lecture-attachments-modal",children:(0,a.jsxs)("div",{className:"lecture-attachments-modal-content",children:[(0,a.jsxs)("div",{className:"lecture-attachments-modal-header",children:[(0,a.jsx)("h3",{children:"Attachments"}),(0,a.jsx)("button",{className:"lecture-attachments-close-btn",id:"lectureAttachmentsCloseBtn",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"lecture-attachments-modal-body",children:[(0,a.jsxs)("div",{className:"lecture-attachments-loading",id:"lectureAttachmentsLoading",children:[(0,a.jsx)("div",{className:"spinner"}),(0,a.jsx)("p",{children:"Loading attachments..."})]}),(0,a.jsxs)("div",{className:"lecture-attachments-content",id:"lectureAttachmentsContent",children:[(0,a.jsxs)("div",{className:"lecture-attachment-section",id:"lectureNotesSection",children:[(0,a.jsxs)("div",{className:"lecture-attachment-section-header",id:"lectureNotesHeader",children:[(0,a.jsx)("span",{className:"lecture-attachment-section-title",children:"Notes"}),(0,a.jsx)("svg",{className:"lecture-attachment-section-arrow",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"})})]}),(0,a.jsx)("div",{className:"lecture-attachment-section-content",id:"lectureNotesContent"})]}),(0,a.jsxs)("div",{className:"lecture-attachment-section",id:"lectureDppSection",children:[(0,a.jsxs)("div",{className:"lecture-attachment-section-header",id:"lectureDppHeader",children:[(0,a.jsx)("span",{className:"lecture-attachment-section-title",children:"DPP"}),(0,a.jsx)("svg",{className:"lecture-attachment-section-arrow",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"})})]}),(0,a.jsx)("div",{className:"lecture-attachment-section-content",id:"lectureDppContent"})]})]}),(0,a.jsx)("div",{className:"lecture-attachments-error",id:"lectureAttachmentsError",style:{display:"none"},children:(0,a.jsx)("p",{children:"Failed to load attachments"})})]})]})})]}),(0,a.jsx)("div",{className:"floating-ai-btn",style:{display:"block"},children:(0,a.jsx)("button",{onClick:()=>y(),className:"ai-float-link",children:(0,a.jsx)("i",{className:"fas fa-robot"})})})]})]});async function n(e,t,n){let a="".concat(e,":").concat(t,":").concat(n,":").concat("studyspark-default-secret-2024"),o=new TextEncoder().encode(a);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",o))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function i(e,t){try{let n=new TextEncoder,a=new TextDecoder,o=n.encode("studyspark-secret-key-2024-pw"),i=new Uint8Array(32);for(let e=0;e<32;e++)i[e]=e<o.length?o[e]:0;let s=await crypto.subtle.importKey("raw",i,{name:"AES-GCM",length:256},!1,["decrypt"]),l=Uint8Array.from(atob(e),e=>e.charCodeAt(0)),c=Uint8Array.from(atob(t),e=>e.charCodeAt(0)),r=await crypto.subtle.decrypt({name:"AES-GCM",iv:c},s,l),d=a.decode(r);return JSON.parse(d)}catch(e){throw console.error("❌ Decryption error:",e),Error("Failed to decrypt response data")}}async function d(e,t){try{var a,o,s,l;try{let s=Date.now().toString(),l=await n(t,e,s),r="".concat(c,"/video-data?batchId=").concat(t,"&childId=").concat(e),d=await fetch(r,{headers:{Accept:"application/json","X-Client-Info":s,"X-User-Agent":l}});if(d.ok){let e=await d.json(),t=await i(e.data,e.iv);if(!t||!1===t.success||t.error){let e=(null==t?void 0:t.error)||(null==t?void 0:t.message)||"Video data not available";throw Error(e)}let n=(null==(a=t.data)?void 0:a.url)||t.url,s=(null==(o=t.data)?void 0:o.signedUrl)||t.signedUrl;if(n&&!n.includes("youtube.com")&&!n.includes("youtu.be"))return s?"".concat(n).concat(s):n}}catch(e){}try{let a=Date.now().toString(),o=await n(t,e,a),l="".concat(c,"/video-url?batchId=").concat(t,"&childId=").concat(e),r=await fetch(l,{headers:{Accept:"application/json","X-Client-Info":a,"X-User-Agent":o}});if(r.ok){let e=await r.json(),t=await i(e.data,e.iv);if(!t||!1===t.success||t.error){let e=(null==t?void 0:t.error)||(null==t?void 0:t.message)||"Video URL not available";throw Error(e)}let n=(null==(s=t.data)?void 0:s.video_url)||t.video_url;if(n&&!(n=n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'")).includes("youtube.com")&&!n.includes("youtu.be"))return n}}catch(e){}try{let a=Date.now().toString(),o=await n(t,e,a),s="".concat(c,"/video?batch_id=").concat(t,"&child_id=").concat(e),r=await fetch(s,{headers:{Accept:"application/json","X-Client-Info":a,"X-User-Agent":o}});if(r.ok){let e=await r.json(),t=await i(e.data,e.iv);if(!t||!1===t.success||t.error){let e=(null==t?void 0:t.error)||(null==t?void 0:t.message)||"Video not available";throw Error(e)}let n=(null==(l=t.data)?void 0:l.video_url)||t.video_url;if(n&&!(n=n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'")).includes("youtube.com")&&!n.includes("youtu.be"))return n}}catch(e){}throw Error("Failed to fetch video URL")}catch(e){throw e}}async function f(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{var a;let o={url:e.replace("/master.mpd","/hls/".concat(t,"/main.m3u8")),quality:t};n&&(o.title=n);let i=await fetch("".concat(c,"/download"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!i.ok)throw Error("Conversion failed");let s=await i.json(),l=s.hlsUrl||s.url||(null==(a=s.data)?void 0:a.url);if(!l)throw Error("No HLS URL returned");return l}catch(e){throw e}}async function b(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;showLoader(!0);try{let a=e;e&&e.includes(".mpd")&&(a=await f(e,t,n)),await v(a),showNotification("Download link copied to clipboard!","success")}catch(e){console.error("Download failed:",e),showNotification("Download failed. Please try again.","error")}finally{showLoader(!1)}}async function v(e){try{await navigator.clipboard.writeText(e)}catch(n){let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}}async function w(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;showLoader(!0);try{let a=await d(e,t);showLoader(!1),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.querySelector(".quality-selection-modal");n&&n.remove();let a=document.createElement("div");a.className="quality-selection-modal",a.innerHTML='\n      <div class="quality-modal-content">\n        <div class="quality-modal-header">\n          <h3>Select Download Quality</h3>\n          <button class="quality-close-btn">\xd7</button>\n        </div>\n        <div class="quality-modal-body">\n          <div class="quality-option" data-quality="720">\n            <div class="quality-info">\n              <div class="quality-label">720p HD</div>\n              <div class="quality-desc">High Quality (Recommended)</div>\n            </div>\n          </div>\n          <div class="quality-option" data-quality="480">\n            <div class="quality-info">\n              <div class="quality-label">480p</div>\n              <div class="quality-desc">Standard Quality</div>\n            </div>\n          </div>\n          <div class="quality-option" data-quality="360">\n            <div class="quality-info">\n              <div class="quality-label">360p</div>\n              <div class="quality-desc">Low Quality</div>\n            </div>\n          </div>\n          <div class="quality-option" data-quality="240">\n            <div class="quality-info">\n              <div class="quality-label">240p</div>\n              <div class="quality-desc">Lowest Quality</div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <style>\n        .quality-selection-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); backdrop-filter: blur(5px); z-index: 10000; display: flex; align-items: center; justify-content: center; }\n        .quality-modal-content { background: #1e1e1e; border-radius: 12px; width: 90%; max-width: 400px; overflow: hidden; box-shadow: 0 4px 20px rgba(0,0,0,0.6); }\n        .quality-modal-header { padding: 20px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }\n        .quality-modal-header h3 { margin: 0; color: #fff; font-size: 18px; font-weight: 600; }\n        .quality-close-btn { background: none; border: none; color: #fff; font-size: 28px; cursor: pointer; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border-radius: 50%; transition: all 0.2s; }\n        .quality-close-btn:hover { background: #333; }\n        .quality-modal-body { padding: 20px; display: flex; flex-direction: column; gap: 12px; }\n        .quality-option { background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 16px; cursor: pointer; transition: all 0.2s; }\n        .quality-option:hover { background: rgba(0,136,204,0.2); border-color: rgba(0,136,204,0.4); transform: translateY(-1px); }\n        .quality-label { font-size: 16px; font-weight: 600; color: #fff; }\n        .quality-desc { font-size: 13px; color: #999; margin-top: 4px; }\n      </style>\n    ',document.body.appendChild(a),a.querySelector(".quality-close-btn").onclick=()=>a.remove(),a.onclick=e=>{e.target===a&&a.remove()},a.querySelectorAll(".quality-option").forEach(n=>{n.onclick=async()=>{let o=n.dataset.quality;a.remove(),await b(e,o,t)}})}(a,n)}catch(e){showLoader(!1),console.error("Failed to fetch video URL:",e),showNotification("Batch Not Available.","error")}}}window.getCompletedLectures=r,window.saveCompletedLectures=d,window.isLectureCompleted=p,window.getCompletedDpps=r,window.saveCompletedDpps=d,window.isDppCompleted=p,window.toggleLectureCompletion=(e,t)=>u(e,"lecture",t),window.toggleDppCompletion=(e,t)=>u(e,"dpp",t),window.getCompleted=r,window.saveCompleted=d,window.isItemCompleted=p,window.showTelegramPopup=m,window.hideTelegramPopup=h,window.closeTelegramPopup=function(){h()},window.showAIPopup=y,window.hideAIPopup=g,window.closeAIPopup=function(){g()},window.showSidebar=f,window.hideSidebar=b,window.toggleSidebar=v,window.initSidebarTypewriterEffect=x,window.initSidebarEventListeners=k}},e=>{e.O(0,[975,228,848,631,809,586,376,529,593,540,74,76,883,121,358],()=>e(e.s=6768)),_N_E=e.O()}]);